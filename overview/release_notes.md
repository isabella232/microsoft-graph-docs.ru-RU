# <a name="known-issues-with-microsoft-graph"></a>Известные проблемы с Microsoft Graph

В этой статье описываются известные проблемы, связанные с Microsoft Graph. Сведения о последних обновлениях см. в [журнале изменений Microsoft Graph](http://graph.microsoft.io/en-us/changelog).

## <a name="graph-quick-start"></a>Краткое руководство по Graph
По состоянию на 30 апреля 2017 г. обнаружена ошибка. URL-адрес перенаправления настроен неправильно для Asp.Net MVC, Node.js, Angular, PHP, Python и Ruby. Мы работаем над тем, чтобы исправление стало доступным в рабочей среде. Обходное решение приведено в [пошаговых инструкциях для начала работы](https://developer.microsoft.com/en-us/graph/docs/get-started/get-started).

## <a name="graph-explorer"></a>Песочница Graph
Мы отключили вход в Graph Explorer с помощью учетных записей Майкрософт в связи с неполадкой системы. Мы активно работаем над исправлением и обновим этот текст, когда оно будет готово.  

Вход в браузерах Internet Explorer и Microsoft Edge не был возможным. Эта проблема устранена 2 февраля 2017 г.

## <a name="users"></a>Пользователи
#### <a name="no-instant-access-after-creation"></a>Нет мгновенного доступа после создания
Пользователей можно создавать мгновенно с помощью метода POST для объекта user. Для доступа к службам Office 365 пользователю нужна соответствующая лицензия. Из-за распределенного характера службы файлы, сообщения и события этого пользователя станут доступны посредством API Microsoft Graph через 15 минут после назначения лицензии. В течение этого времени приложения будут получать ошибку HTTP 404. 

#### <a name="photo-restrictions"></a>Ограничения для фотографий
Просмотр и обновление фотографии профиля пользователя возможны, только если у пользователя есть почтовый ящик. Кроме того, все фотографии, которые *могли* ранее храниться со свойством **thumbnailPhoto** (с помощью предварительной версии единого API Office 365, Azure AD Graph или службы синхронизации AD Connect), больше не будут доступны через свойство фотографии пользователя Microsoft Graph. В этом случае сбой при просмотре или обновлении фотографии вызовет следующую ошибку:

```javascript
    {
      "error": {
        "code": "ErrorNonExistentMailbox",
        "message": "The SMTP address has no mailbox associated with it."
      }
    }
```

 > **Примечание.**  Вскоре после выхода общедоступной версии будет добавлена возможность хранения и извлечения фотографий профилей пользователей, даже если у них нет почтового ящика, и эта ошибка должна исчезнуть.


#### <a name="adding-and-accessing-ics-based-calendars-in-users-mailbox"></a>Добавление календарей ICS в почтовый ящик пользователя и доступ к ним
В настоящее время календари ICS поддерживаются частично:

* Вы можете добавить календарь ICS в почтовый ящик пользователя через интерфейс пользователя, но не через API Microsoft Graph. 
* [Список календарей пользователя](http://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/user_list_calendars) позволяет получить свойства **name**, **color** и **id** всех [календарей](http://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/resources/calendar) в группе календарей пользователя по умолчанию или указанной группе календарей, в том числе календарей ICS. URL-адрес ICS невозможно хранить и открывать в календаре ресурсов.
* Вы также можете [вывести список событий](http://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/calendar_list_events) календаря ICS.

#### <a name="using-delta-query"></a>Работа с запросами изменений
Об известных проблемах, связанных с использованием запросов изменений, можно узнать в [соответствующем разделе](#delta-query) этой статьи.

## <a name="groups"></a>Группы
#### <a name="policy"></a>Политика
С помощью Microsoft Graph можно создать группу Office 365 и присвоить ей название в обход всех групповых политик Office 365, настроенных через Outlook Web App. 

#### <a name="group-permission-scopes"></a>Области разрешений для групп
Microsoft Graph предоставляет две области разрешений (*Group.Read.All* и *Group.ReadWrite.All*) для доступа к API групп.  
В полной версии, в отличие от предварительной, эти разрешения должен подтвердить администратор.  В будущем мы планируем добавить новые области разрешений для групп, которые смогут предоставлять пользователи.

Кроме того, только API для базового администрирования групп и управления ими поддерживает доступ с помощью разрешений только для приложений или делегированных разрешений. Все остальные функции API групп поддерживают только делегированные разрешения. 

Примеры функций групп, поддерживающих разрешения только для приложений и делегированные разрешения: 

* создание и удаление групп;
* получение и обновление свойств групп, связанных с администрированием групп и управлением ими;
* [параметры каталогов](../api-reference/v1.0/resources/directoryobject.md), типы и синхронизация групп;
* владельцы и члены групп.


Примеры функций групп, поддерживающих только делегированные разрешения:

* групповые беседы, события, фотографии;
* внешние отправители, разрешенные или запрещенные отправители, подписка на группы;
* избранное пользователей и счетчик непросмотренных элементов.


#### <a name="adding-and-getting-attachments-of-group-posts"></a>Добавление и получение вложений в записях групп
В настоящее время при [добавлении](http://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/post_post_attachments) вложений в записи группы, [отображении](http://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/post_list_attachments) и получении вложений возвращается сообщение об ошибке "Запрос OData не поддерживается". Для версий `/v1.0` и `/beta` подготовлено исправление. Оно станет доступно всем пользователям в конце января 2016 года.


#### <a name="setting-the-allowexternalsenders-property"></a>Установка свойства allowExternalSenders
В настоящее время существует проблема, из-за которой невозможно установить свойство **allowExternalSenders** группы в операции POST или PATCH как в `/v1.0`, так и в `/beta`.

#### <a name="using-delta-query"></a>Работа с запросами изменений
Об известных проблемах, связанных с использованием запросов изменений, можно узнать в [соответствующем разделе](#delta-query) этой статьи.

## <a name="contacts"></a>Контакты

#### <a name="organization-contacts-available-in-only-beta"></a>Контакты организации доступны только в бета-версии
В настоящее время поддерживаются только личные контакты. В настоящее время контакты организации не поддерживаются в версии `/v1.0`, но их можно найти в версии `/beta`.

#### <a name="default-contacts-folder"></a>Папка контактов по умолчанию

В версии `/v1.0` запрос `GET /me/contactFolders` не включает папку контактов пользователя по умолчанию. 

Эта ошибка будет исправлена. Чтобы получить идентификатор папки контактов по умолчанию, вы можете использовать следующий запрос на [отображение контактов](http://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/user_list_contacts) и свойство **parentFolderId**:

```
GET https://graph.microsoft.com/v1.0/me/contacts?$top=1&$select=parentFolderId
```
В указанном выше запросе:
1. `/me/contacts?$top=1` возвращает свойства [контакта](http://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/resources/contact) в папке контактов по умолчанию.
2. При добавлении `&$select=parentFolderId` возвращается только свойство контакта **parentFolderId** — идентификатор папки контактов по умолчанию.


#### <a name="accessing-contacts-via-a-contact-folder-in-beta"></a>Доступ к контактам через папку контактов в бета-версии
В настоящее время в версии `/beta` существует проблема, из-за которой нельзя получить доступ к ресурсу [contact](../api-reference/beta/resources/contact.md), указав его родительскую папку в URL-адресе запроса REST, как показано в 2 приведенных ниже сценариях.

* Доступ к контакту из папки верхнего уровня [contactFolder](../api-reference/beta/resources/contactfolder.md).
```http
GET /me/contactfolders/{id}/contacts/{id}
GET /users/{id | userPrincipalName}/contactfolders/{id}/contacts/{id}
```
* Доступ к контакту в дочерней папке папки **contactFolder**.  В приведенном ниже примере показан один уровень вложения, но для хранения контакта допускается несколько.
```http
GET /me/contactFolder/{id}/childFolders/{id}/.../contacts/{id}
GET /users/{id | userPrincipalName}/contactFolders/{id}/childFolders/{id}/contacts/{id}
```

Кроме того, вы можете просто [получить](../api-reference/beta/api/contact_get.md) контакт по его идентификатору, как показано ниже, так как конечная точка /contacts для запроса GET в версии `/beta` применяется ко всем контактам в почтовом ящике пользователя:

```http
GET /me/contacts/{id}
GET /users/{id | userPrincipalName}/contacts/{id}
```

## <a name="messages"></a>Сообщения
#### <a name="the-comment-parameter-for-creating-a-draft"></a>Параметр comment для создания черновика
Параметр **comment** для создания ответа или черновика ([createReply](../api-reference/v1.0/api/message_createreply.md), [createReplyAll](../api-reference/v1.0/api/message_createreplyall.md), [createForward](../api-reference/v1.0/api/message_createforward.md)) не включается в текст полученного черновика сообщения.  


## <a name="drives-files-and-content-streaming"></a>Диски, файлы и потоковая передача контента
* При первом доступе к личному диску пользователя с помощью Microsoft Graph до открытия им своего личного сайта в браузере возвращается ответ 401.

## <a name="functionality-available-only-in-office-365-rest-apis"></a>Функции, доступные только в REST API Office 365

Некоторые функции еще не доступны в Microsoft Graph. Если вам не удается найти нужные функции, вы можете использовать [интерфейсы REST API для Office 365](https://msdn.microsoft.com/en-us/office/office365/api/api-catalog), связанные с конкретными конечными точками.


#### <a name="batching"></a>Пакетная обработка
В Microsoft Graph пакетная обработка не поддерживается. Тем не менее можно использовать конечную точку бета-версии Outlook и [пакетные вызовы Outlook REST](https://msdn.microsoft.com/en-us/office/office365/api/batch-outlook-rest-requests). 

#### <a name="availability-in-china"></a>Доступность в Китае
Служба Microsoft Graph предоставляется компанией 21Vianet (и теперь доступна в Китае). Дополнительные сведения, в том числе ограничения, см. в документе о [независимых облачных развертываниях Microsoft Graph](http://developer.microsoft.com/en-us/graph/docs/overview/deployments).

#### <a name="service-actions-and-functions"></a>Действия и функции службы
В Microsoft Graph недоступны методы `isMemberOf` и `getObjectsById`.

## <a name="microsoft-graph-permissions"></a>Разрешения Microsoft Graph
Последние сведения о разрешениях для приложений и делегированных разрешениях, поддерживаемых в Microsoft Graph, см. в статье, посвященной [Области разрешений](http://developer.microsoft.com/en-us/graph/docs/authorization/permission_scopes). Кроме того, для `v1.0` действуют следующие ограничения:

|Разрешение |    Тип разрешения | Ограничение |    Альтернатива |
|-----------|-----------------|------------|--------------|
|_User.ReadWrite_| Делегированное    | Невозможно обновить номер мобильного телефона.|    Выберите также `Directory.AccessAsUser.All`.| 
|_User.ReadWrite.All_|    Делегированное|    С объектом `User` невозможно выполнять никаких операций CRUD, кроме обновления фотографии пользователя в формате HD и расширенных свойств профиля.|    Выберите также `Directory.ReadWrite.All` или `Directory.AccessAsUser.All`, если необходимо удалить пользователя.|
|_User.Read.All_|    Приложение    |Невозможно выполнять операции чтения с другими пользователями.|    Выберите также `Directory.Read.All`.|
| _User.ReadWrite.All_ |    Приложение |    С объектом `User` невозможно выполнять никаких операций CRUD, кроме обновления фотографии пользователя в формате HD и расширенных свойств профиля. |    Выберите также `Directory.ReadWrite.All`. **ПРИМЕЧАНИЕ**. Удалять пользователей невозможно.|
|_Group.Read.All_    | Application; |    Невозможно перечислять группы или их участников.  При этом можно просматривать содержимое групп Office.    | Выберите также `Directory.Read.All`. |
|_Group.ReadWrite.All_    | Приложение    | Невозможно перечислять группы или их участников, создавать группы, обновлять членство в группах или удалять их.  При этом можно просматривать и обновлять содержимое групп Office.    | Выберите также `Directory.ReadWrite.All`. **ПРИМЕЧАНИЕ**.  Удаление групп невозможно.|

Кроме того, для версии `/beta` действуют следующие ограничения:

|Разрешение |    Тип разрешения | Ограничение |    Альтернатива |
|-----------|-----------------|------------|--------------|
| _Group.ReadWrite.All_    | Делегированное    | Невозможно просматривать или обновлять задачи планировщика в группах Office.    | Выберите также `Tasks.ReadWrite`.|
|_Tasks.ReadWrite_    | Делегированное    | Невозможно просматривать или обновлять задачи вошедшего пользователя.| Выберите также `Group.ReadWrite.All`.|

## <a name="odata-related-limitations"></a>Ограничения, связанные с OData
* Ограничения **$expand**: 
 * Отсутствует поддержка `nextLink`.
 * Поддерживается не более одного уровня развертывания.
 * Не поддерживаются дополнительные параметры (**$filter**, **$select**).
* Не поддерживается несколько пространств имен.
* Не поддерживаются запросы GET для `$ref` и приведение для пользователей, групп, устройств, субъектов-служб и приложений.
* Не поддерживается `@odata.bind`.  Это значит, что разработчики не смогут правильно задавать параметры `Accepted` и `RejectedSenders` для группы.
* Отсутствует `@odata.id` для навигации по объектам без вложений (например, сообщениям) при использовании минимальных метаданных.
* Не поддерживаются фильтрация и поиск для нескольких рабочих нагрузок. 
* Полнотекстовый поиск (с помощью параметра **$search**) доступен только для некоторых объектов, например сообщений.

  >  Ваш отзыв важен для нас. Для связи с нами используйте сайт [Stack Overflow](http://stackoverflow.com/questions/tagged/office365). Помечайте свои вопросы тегами {MicrosoftGraph} и {office365}.

## <a name="delta-query"></a>Запрос на получение различий

Отслеживание изменений в отношениях между пользователями и группами поддерживается только в рамках определенного класса ресурсов, для которого отслеживаются изменения. Например, если клиент отслеживает изменения в *группах* и выбрал отношение *members*, то он будет получать сведения об изменении участников, только если эти участники также являются *группами*. Другими словами, отслеживание членства в группах для пользователей еще не поддерживается. Разработчики Microsoft Graph понимают, что это очень важный сценарий, и планируют вскоре выпустить обновление.

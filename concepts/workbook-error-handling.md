---
title: Обработка ошибок для API Excel в Microsoft Graph
description: Инструкции по обработке ошибок для API Excel в Microsoft Graph
author: grangeryy
localization_priority: Normal
ms.prod: excel
ms.openlocfilehash: bbf60c34c66ffd42004696d5f8591dd9a2996457
ms.sourcegitcommit: c28da0e5feea4791c19663a30b223a0a5da0ed02
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/15/2020
ms.locfileid: "48471429"
---
# <a name="error-handling-for-excel-apis-in-microsoft-graph"></a><span data-ttu-id="f783e-103">Обработка ошибок для API Excel в Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="f783e-103">Error handling for Excel APIs in Microsoft Graph</span></span>

<span data-ttu-id="f783e-104">В этой статье приводятся общие инструкции по обработке ошибок, возвращаемых API Excel в Microsoft Graph при сбое запроса, отправленного через API.</span><span class="sxs-lookup"><span data-stu-id="f783e-104">This article provides general instructions and suggestions for handling errors that are returned by the Excel APIs in Microsoft Graph when a request sent through the API fails.</span></span>

## <a name="types-of-error-responses"></a><span data-ttu-id="f783e-105">Типы ответных сообщений об ошибках</span><span class="sxs-lookup"><span data-stu-id="f783e-105">Types of error responses</span></span>

<span data-ttu-id="f783e-106">API Excel в Microsoft Graph возвращают ошибки двух типов.</span><span class="sxs-lookup"><span data-stu-id="f783e-106">Excel APIs in Microsoft Graph return two types of errors.</span></span> <span data-ttu-id="f783e-107">Один из них — обычный ответ об ошибке, который выглядит следующим образом.</span><span class="sxs-lookup"><span data-stu-id="f783e-107">One is the regular error response, which looks like the following.</span></span>

```http
HTTP/1.1 <HTTP status code>
Content-type: application/json

{
  "error": <Error object>
}
```

<span data-ttu-id="f783e-108">Второй — из шаблона долгосрочной операции, который может возвращать `200 OK` код состояния HTTP и `failed` состояние операции в теле отклика, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="f783e-108">The second is from the long-running operation pattern, which can return a `200 OK` HTTP status code and `failed` operation status in response body, as in the following example.</span></span>

```http
HTTP/1.1 200 OK
Content-type: application/json

{
  "status": "failed",
  "error": <Error object>
}
```

<span data-ttu-id="f783e-109">Для обоих этих сообщений об ошибках объект Error имеет следующую структуру.</span><span class="sxs-lookup"><span data-stu-id="f783e-109">For both of these error responses, the error object has the following structure.</span></span>

><span data-ttu-id="f783e-110">**Примечание:** Ответы об ошибках, которые соответствуют определению в спецификации [OData версии 4](https://docs.oasis-open.org/odata/odata-json-format/v4.0/os/odata-json-format-v4.0-os.html#_Toc372793091) для ответов об ошибках.</span><span class="sxs-lookup"><span data-stu-id="f783e-110">**Note:** Error responses follow the definition in the [OData v4](https://docs.oasis-open.org/odata/odata-json-format/v4.0/os/odata-json-format-v4.0-os.html#_Toc372793091) specification for error responses.</span></span>

```json
{
  "code": "string",
  "message": "string",
  "innerError": { "@odata.type": "odata.error" }
}
```

<span data-ttu-id="f783e-111">Объект `innerError` может рекурсивно содержать дополнительные объекты `innerError` с другими, более подробными кодами ошибок.</span><span class="sxs-lookup"><span data-stu-id="f783e-111">The `innerError` object might recursively contain more `innerError` objects with additional, more specific error codes.</span></span> <span data-ttu-id="f783e-112">Например, объект Error может содержать более подробные сведения об ошибке в коде и сообщении об ошибке второго уровня, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="f783e-112">For example, the error object might contain more detailed error information in the second-level error code and message, as shown.</span></span>

```json
{
  "code": "Top-level error code",
  "message": "Top-level error message",
  "innerError": {
    "code": "Second-level error code",
    "message": "Second-level error message",
    "innerError": { "@odata.type": "odata.error" }
  }
}
```

## <a name="steps-to-handle-error-responses"></a><span data-ttu-id="f783e-113">Действия для обработки откликов об ошибках</span><span class="sxs-lookup"><span data-stu-id="f783e-113">Steps to handle error responses</span></span>

<span data-ttu-id="f783e-114">Клиенты Microsoft Graph могут использовать следующие действия для обработки ошибок, возникающих в API Excel.</span><span class="sxs-lookup"><span data-stu-id="f783e-114">Microsoft Graph clients can use the following steps to handle errors that occur with Excel APIs.</span></span>

### <a name="1-determine-whether-it-is-a-long-running-operation-error"></a><span data-ttu-id="f783e-115">1. Определите, является ли ошибка длительной операции</span><span class="sxs-lookup"><span data-stu-id="f783e-115">1. Determine whether it is a long-running operation error</span></span>

<span data-ttu-id="f783e-116">Перед обработкой ошибки первым делом необходимо определить, является ли ответ на сообщение об ошибке шаблоном длительной операции или обычным шаблоном.</span><span class="sxs-lookup"><span data-stu-id="f783e-116">Before handling an error, the first step is to determine whether the error response is from a long-running operation pattern or a regular pattern.</span></span> <span data-ttu-id="f783e-117">При длительной операции с операцией будет возвращен `200 OK` код состояния HTTP и `failed` состояние операции в тексте отклика.</span><span class="sxs-lookup"><span data-stu-id="f783e-117">A long-running operation error will return a `200 OK` HTTP status code and `failed` operation status in response body.</span></span> <span data-ttu-id="f783e-118">Регулярный ответ об ошибке вернет соответствующий код состояния ошибки HTTP.</span><span class="sxs-lookup"><span data-stu-id="f783e-118">A regular error response will return a corresponding HTTP error status code.</span></span> 

### <a name="2-parse-second-level-error-code"></a><span data-ttu-id="f783e-119">2. синтаксический анализ кода ошибки второго уровня</span><span class="sxs-lookup"><span data-stu-id="f783e-119">2. Parse second-level error code</span></span>

<span data-ttu-id="f783e-120">Как для долгосрочной операции, так и для обычного шаблона рекомендуется сначала выполнить инструкции для ошибок второго уровня.</span><span class="sxs-lookup"><span data-stu-id="f783e-120">For both the long-running operation pattern and the regular pattern, we recommend that you first follow the instructions for second-level errors.</span></span> <span data-ttu-id="f783e-121">Код ошибки не зависит от регистра.</span><span class="sxs-lookup"><span data-stu-id="f783e-121">The error code is case insensitive.</span></span> <span data-ttu-id="f783e-122">В следующей таблице приведены инструкции по некоторым ошибкам.</span><span class="sxs-lookup"><span data-stu-id="f783e-122">The following table lists instructions for some of the errors.</span></span> <span data-ttu-id="f783e-123">В любой момент служба может добавить новые коды ошибок.</span><span class="sxs-lookup"><span data-stu-id="f783e-123">The service might add new error codes at any time.</span></span>

| <span data-ttu-id="f783e-124">Код</span><span class="sxs-lookup"><span data-stu-id="f783e-124">Code</span></span>                               | <span data-ttu-id="f783e-125">Инструкции</span><span class="sxs-lookup"><span data-stu-id="f783e-125">Instructions</span></span>
|:-----------------------------------|:---------------------------------------------
| <span data-ttu-id="f783e-126">**акцессконфликт**</span><span class="sxs-lookup"><span data-stu-id="f783e-126">**accessConflict**</span></span>   | <span data-ttu-id="f783e-127">Неудачный запрос конфликтует с другими клиентами, обращающимися к книге (например, другой клиент заблокировал книгу для изменения).</span><span class="sxs-lookup"><span data-stu-id="f783e-127">The failed request conflicts with other clients accessing the workbook (for example, another client has locked the workbook for edit).</span></span> <span data-ttu-id="f783e-128">Клиент Microsoft Graph не ожидается повторно отправлять невыполненный запрос до устранения конфликта.</span><span class="sxs-lookup"><span data-stu-id="f783e-128">The Microsoft Graph client is not expected to resend the failed request until the conflict is resolved.</span></span> <span data-ttu-id="f783e-129">Конечный пользователь, xN, нажмите, чтобы вручную выполнить те же операции с Excel Online, чтобы получить дополнительные сведения о конфликте.</span><span class="sxs-lookup"><span data-stu-id="f783e-129">An end user xN choose to manually perform the same operations with Excel Online to get more details about the conflict.</span></span>
| <span data-ttu-id="f783e-130">**accessDenied**</span><span class="sxs-lookup"><span data-stu-id="f783e-130">**accessDenied**</span></span>   | <span data-ttu-id="f783e-131">Невозможно выполнить запрошенную операцию (например, выполнить изменения в заблокированных ячейках).</span><span class="sxs-lookup"><span data-stu-id="f783e-131">You cannot perform the requested operation (for example, performing changes to locked cells).</span></span> <span data-ttu-id="f783e-132">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-132">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-133">**бадрекуестункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-133">**badRequestUncategorized**</span></span>    | <span data-ttu-id="f783e-134">В неудачном запросе обнаружена неопределенная ошибка.</span><span class="sxs-lookup"><span data-stu-id="f783e-134">An unspecified error is found in the failed request.</span></span> <span data-ttu-id="f783e-135">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-135">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-136">**конфликтункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-136">**conflictUncategorized**</span></span>                   | <span data-ttu-id="f783e-137">Неудачный запрос конфликтует с определенным состоянием сервера.</span><span class="sxs-lookup"><span data-stu-id="f783e-137">The failed request conflicts with certain server state.</span></span> <span data-ttu-id="f783e-138">Клиент Microsoft Graph не ожидается повторно отправлять невыполненный запрос до устранения конфликта.</span><span class="sxs-lookup"><span data-stu-id="f783e-138">The Microsoft Graph client is not expected to resend the failed request until the conflict is resolved.</span></span> <span data-ttu-id="f783e-139">Конечный пользователь может вручную выполнить те же операции с Excel Online, чтобы получить дополнительные сведения о конфликте.</span><span class="sxs-lookup"><span data-stu-id="f783e-139">An end user can choose to manually perform the same operations with Excel Online to get more details about the conflict.</span></span>
| <span data-ttu-id="f783e-140">**филтередранжеконфликт**</span><span class="sxs-lookup"><span data-stu-id="f783e-140">**filteredRangeConflict**</span></span>                   | <span data-ttu-id="f783e-141">Не удалось выполнить операцию, так как она конфликтует с отфильтрованным диапазоном.</span><span class="sxs-lookup"><span data-stu-id="f783e-141">The operation failed because it conflicts with a filtered range.</span></span> <span data-ttu-id="f783e-142">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-142">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-143">**форбидденункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-143">**forbiddenUncategorized**</span></span>                    | <span data-ttu-id="f783e-144">Неудачный запрос не разрешен.</span><span class="sxs-lookup"><span data-stu-id="f783e-144">The failed request is not allowed.</span></span> <span data-ttu-id="f783e-145">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-145">The Microsoft Graph client is not expected to resend the failed request.</span></span> <span data-ttu-id="f783e-146">Конечный пользователь может вручную выполнить те же операции с Excel Online, чтобы получить дополнительные сведения об ограничениях.</span><span class="sxs-lookup"><span data-stu-id="f783e-146">An end user can choose to manually perform the same operations with Excel Online to get more details about the restrictions.</span></span>
| <span data-ttu-id="f783e-147">**гатевайтимеаутункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-147">**gatewayTimeoutUncategorized**</span></span>         | <span data-ttu-id="f783e-148">Служба не смогла выполнить запрос в течение отведенного времени.</span><span class="sxs-lookup"><span data-stu-id="f783e-148">The service wasn’t able to complete the request within the time limit.</span></span>
| <span data-ttu-id="f783e-149">**generalException**</span><span class="sxs-lookup"><span data-stu-id="f783e-149">**generalException**</span></span>         | <span data-ttu-id="f783e-150">При обработке запроса возникла внутренняя ошибка.</span><span class="sxs-lookup"><span data-stu-id="f783e-150">An internal error occurred while processing the request.</span></span> <span data-ttu-id="f783e-151">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-151">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-152">**инсертделетеконфликт**</span><span class="sxs-lookup"><span data-stu-id="f783e-152">**insertDeleteConflict**</span></span>         | <span data-ttu-id="f783e-153">Операция вставки или удаления привела к конфликту.</span><span class="sxs-lookup"><span data-stu-id="f783e-153">The insert or delete operation attempted resulted in a conflict.</span></span> <span data-ttu-id="f783e-154">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-154">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-155">**интерналсервереррорункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-155">**internalServerErrorUncategorized**</span></span>       | <span data-ttu-id="f783e-156">Произошла неуказанная ошибка.</span><span class="sxs-lookup"><span data-stu-id="f783e-156">An unspecified error has occurred.</span></span> <span data-ttu-id="f783e-157">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-157">The Microsoft Graph client is not expected to resend the failed request.</span></span> <span data-ttu-id="f783e-158">Если сеанс указан в неудачном запросе, дальнейший доступ к сеансу не ожидается.</span><span class="sxs-lookup"><span data-stu-id="f783e-158">If a session is specified in the failed request, further access to the session is not expected either.</span></span>
| <span data-ttu-id="f783e-159">**invalidArgument**</span><span class="sxs-lookup"><span data-stu-id="f783e-159">**invalidArgument**</span></span>         | <span data-ttu-id="f783e-160">Аргумент недопустим, отсутствует или имеет неправильный формат.</span><span class="sxs-lookup"><span data-stu-id="f783e-160">The argument is invalid or missing or has an incorrect format.</span></span> <span data-ttu-id="f783e-161">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-161">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-162">**инвалидреференце**</span><span class="sxs-lookup"><span data-stu-id="f783e-162">**invalidReference**</span></span>         | <span data-ttu-id="f783e-163">Эта ссылка недопустима для текущей операции.</span><span class="sxs-lookup"><span data-stu-id="f783e-163">This reference is not valid for the current operation.</span></span> <span data-ttu-id="f783e-164">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-164">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-165">**инвалидсессионакцессконфликт**</span><span class="sxs-lookup"><span data-stu-id="f783e-165">**invalidSessionAccessConflict**</span></span>             | <span data-ttu-id="f783e-166">Сеанс, указанный в запросе, является недопустимым из-за конфликтов с другими клиентами, обращающимися к книге (например, другой клиент заблокировал книгу для изменения).</span><span class="sxs-lookup"><span data-stu-id="f783e-166">The session specified in the request is invalid due to conflicts with other clients that are accessing the workbook (for example, another client has locked the workbook for edit).</span></span> <span data-ttu-id="f783e-167">Дальнейший доступ к сеансу, указанному в неудачном запросе, не ожидается.</span><span class="sxs-lookup"><span data-stu-id="f783e-167">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="f783e-168">Повторное создание сеансов с одним и тем же запросом **креатесессион** не ожидается, пока не будет устранен конфликт.</span><span class="sxs-lookup"><span data-stu-id="f783e-168">Recreating sessions with the same **createSession** request is not expected until the conflict is resolved.</span></span> <span data-ttu-id="f783e-169">Повторное создание сеансов с другим запросом **креатесессион** может завершиться неудачно.</span><span class="sxs-lookup"><span data-stu-id="f783e-169">Recreating sessions with a different **createSession** request might or might not succeed.</span></span> <span data-ttu-id="f783e-170">Конечный пользователь может вручную выполнить те же операции с Excel Online, чтобы получить дополнительные сведения о конфликте.</span><span class="sxs-lookup"><span data-stu-id="f783e-170">An end user can choose to manually perform the same operations with Excel Online to get more details about the conflict.</span></span>
| <span data-ttu-id="f783e-171">**инвалидсессионаусентикатион**</span><span class="sxs-lookup"><span data-stu-id="f783e-171">**invalidSessionAuthentication**</span></span>         | <span data-ttu-id="f783e-172">Сеанс, указанный в запросе, является недопустимым из-за ошибки проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="f783e-172">The session specified in the request is invalid due to an authentication error.</span></span> <span data-ttu-id="f783e-173">Дальнейший доступ к сеансу, указанному в неудачном запросе, не ожидается.</span><span class="sxs-lookup"><span data-stu-id="f783e-173">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="f783e-174">Повторное создание сеансов с одним и тем же запросом **креатесессион** не ожидается, пока не будут предоставлены соответствующие сведения о проверке подлинности.</span><span class="sxs-lookup"><span data-stu-id="f783e-174">Recreating sessions with the same **createSession** request is not expected until appropriate authentication information is provided.</span></span>
| <span data-ttu-id="f783e-175">**инвалидсессионнотфаунд**</span><span class="sxs-lookup"><span data-stu-id="f783e-175">**invalidSessionNotFound**</span></span>         | <span data-ttu-id="f783e-176">Сеанс, указанный в запросе, является недопустимым, так как не удается найти книгу.</span><span class="sxs-lookup"><span data-stu-id="f783e-176">The session specified in the request is invalid because the workbook can’t be found.</span></span> <span data-ttu-id="f783e-177">Дальнейший доступ к сеансу, указанному в неудачном запросе, не ожидается.</span><span class="sxs-lookup"><span data-stu-id="f783e-177">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="f783e-178">Повторное создание сеансов с одним и тем же запросом **креатесессион** не ожидается.</span><span class="sxs-lookup"><span data-stu-id="f783e-178">Recreating sessions with the same **createSession** request is not expected.</span></span>
| <span data-ttu-id="f783e-179">**инвалидсессионрекреатабле**</span><span class="sxs-lookup"><span data-stu-id="f783e-179">**invalidSessionReCreatable**</span></span>             | <span data-ttu-id="f783e-180">Сеанс, указанный в запросе, не существует или является недопустимым из-за временной ошибки.</span><span class="sxs-lookup"><span data-stu-id="f783e-180">The session specified in the request does not exist or is invalid due to a transient error.</span></span> <span data-ttu-id="f783e-181">Клиент Microsoft Graph может попытаться повторно создать сеанс и возобновить работу.</span><span class="sxs-lookup"><span data-stu-id="f783e-181">The Microsoft Graph client can try to recreate a session and resume the work.</span></span> <span data-ttu-id="f783e-182">Дальнейший доступ к сеансу, указанному в неудачном запросе, не ожидается.</span><span class="sxs-lookup"><span data-stu-id="f783e-182">Further access to the session specified in the failed request is not expected.</span></span>
| <span data-ttu-id="f783e-183">**инвалидсессионрестриктед**</span><span class="sxs-lookup"><span data-stu-id="f783e-183">**invalidSessionRestricted**</span></span>          | <span data-ttu-id="f783e-184">Сеанс, указанный в запросе, является недопустимым из-за конфигураций или ограничений службы.</span><span class="sxs-lookup"><span data-stu-id="f783e-184">The session specified in the request is invalid due to service configurations or restrictions.</span></span> <span data-ttu-id="f783e-185">Дальнейший доступ к сеансу, указанному в неудачном запросе, не ожидается.</span><span class="sxs-lookup"><span data-stu-id="f783e-185">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="f783e-186">Повторное создание сеансов с одним и тем же запросом **креатесессион** не ожидается до тех пор, пока ограничения или конфигурации не заблокировали изменения запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-186">Recreating sessions with the same **createSession** request is not expected until the restrictions or configurations blocking the request changes.</span></span> <span data-ttu-id="f783e-187">Повторное создание сеансов с другим запросом **креатесессион** может завершиться неудачно.</span><span class="sxs-lookup"><span data-stu-id="f783e-187">Recreating sessions with a different **createSession** request might or might not succeed.</span></span> <span data-ttu-id="f783e-188">Конечный пользователь может вручную выполнять те же операции с Excel Online, чтобы получить дополнительные сведения об ограничениях.</span><span class="sxs-lookup"><span data-stu-id="f783e-188">An end user can choose to manually perform the same operations with Excel Online to get more details of the restrictions.</span></span>
| <span data-ttu-id="f783e-189">**инвалидсессионунекспектед**</span><span class="sxs-lookup"><span data-stu-id="f783e-189">**invalidSessionUnexpected**</span></span>                | <span data-ttu-id="f783e-190">Сеанс, указанный в запросе, является недопустимым из-за непредвиденной ошибки.</span><span class="sxs-lookup"><span data-stu-id="f783e-190">The session specified in the request is invalid due to an unexpected issue.</span></span> <span data-ttu-id="f783e-191">Дальнейший доступ к сеансу, указанному в неудачном запросе, не ожидается.</span><span class="sxs-lookup"><span data-stu-id="f783e-191">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="f783e-192">Повторное создание сеансов с одним и тем же запросом **креатесессион** не ожидается.</span><span class="sxs-lookup"><span data-stu-id="f783e-192">Recreating sessions with the same **createSession** request is not expected.</span></span> <span data-ttu-id="f783e-193">Повторное создание сеансов с другим запросом **креатесессион** может завершиться неудачно.</span><span class="sxs-lookup"><span data-stu-id="f783e-193">Recreating sessions with a different **createSession** request might or might not succeed.</span></span>
| <span data-ttu-id="f783e-194">**инвалидсессионунсуппортедворкбук**</span><span class="sxs-lookup"><span data-stu-id="f783e-194">**invalidSessionUnsupportedWorkbook**</span></span>              | <span data-ttu-id="f783e-195">Сеанс, указанный в запросе, является недопустимым, так как книга содержит неподдерживаемые функции или превышает предельный размер.</span><span class="sxs-lookup"><span data-stu-id="f783e-195">The session specified in the request is invalid because the workbook contains unsupported features or exceeds the size limit.</span></span> <span data-ttu-id="f783e-196">Обычно неподдерживаемые факторы представлены другим клиентом, обращающимся к книге.</span><span class="sxs-lookup"><span data-stu-id="f783e-196">Usually the unsupported factors are introduced by another client accessing the workbook.</span></span> <span data-ttu-id="f783e-197">Дальнейший доступ к сеансу, указанному в неудачном запросе, не ожидается.</span><span class="sxs-lookup"><span data-stu-id="f783e-197">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="f783e-198">Повторное создание сеансов с одним и тем же запросом **креатесессион** не ожидается, пока не будут удалены неподдерживаемые факторы.</span><span class="sxs-lookup"><span data-stu-id="f783e-198">Recreating sessions with the same **createSession** request is not expected until the unsupported factors are removed.</span></span> <span data-ttu-id="f783e-199">Повторное создание сеансов с другим запросом Креатесессион может завершиться неудачно.</span><span class="sxs-lookup"><span data-stu-id="f783e-199">Recreating sessions with a different createSession request might or might not succeed.</span></span> <span data-ttu-id="f783e-200">Конечный пользователь может вручную выполнить те же операции с Excel Online, чтобы получить дополнительные сведения о неподдерживаемых факторах, или на рабочем столе Excel, где эта книга может поддерживаться.</span><span class="sxs-lookup"><span data-stu-id="f783e-200">An end user can choose to manually perform the same operations with Excel Online to get more details of the unsupported factors, or with Excel Desktop where the workbook might be supported.</span></span>
| <span data-ttu-id="f783e-201">**итемалреадексистс**</span><span class="sxs-lookup"><span data-stu-id="f783e-201">**itemAlreadyExists**</span></span>         | <span data-ttu-id="f783e-202">Создаваемый ресурс уже существует.</span><span class="sxs-lookup"><span data-stu-id="f783e-202">The resource being created already exists.</span></span> <span data-ttu-id="f783e-203">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-203">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-204">**itemNotFound**</span><span class="sxs-lookup"><span data-stu-id="f783e-204">**itemNotFound**</span></span>         | <span data-ttu-id="f783e-205">Запрашиваемый ресурс не существует.</span><span class="sxs-lookup"><span data-stu-id="f783e-205">The requested resource doesn't exist.</span></span> <span data-ttu-id="f783e-206">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-206">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-207">**месодноталловед**</span><span class="sxs-lookup"><span data-stu-id="f783e-207">**methodNotAllowed**</span></span>         | <span data-ttu-id="f783e-208">Метод HTTP, указанный в запросе, не разрешен для ресурса.</span><span class="sxs-lookup"><span data-stu-id="f783e-208">The HTTP method specified in the request is not allowed on the resource.</span></span> <span data-ttu-id="f783e-209">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-209">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-210">**месодноталловедункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-210">**methodNotAllowedUncategorized**</span></span>              | <span data-ttu-id="f783e-211">Метод HTTP, указанный в запросе, не разрешен для ресурса.</span><span class="sxs-lookup"><span data-stu-id="f783e-211">The HTTP method specified in the request is not allowed on the resource.</span></span> <span data-ttu-id="f783e-212">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-212">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-213">**нонбланкцеллоффшит**</span><span class="sxs-lookup"><span data-stu-id="f783e-213">**nonBlankCellOffSheet**</span></span>         | <span data-ttu-id="f783e-214">Не удается вставить новые ячейки, так как это приведет к поставке непустых ячеек за пределами листа.</span><span class="sxs-lookup"><span data-stu-id="f783e-214">Can't insert new cells because it would push non-empty cells off the end of the worksheet.</span></span> <span data-ttu-id="f783e-215">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-215">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-216">**нотфаундункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-216">**notFoundUncategorized**</span></span>             | <span data-ttu-id="f783e-217">Не удается найти запрошенный ресурс.</span><span class="sxs-lookup"><span data-stu-id="f783e-217">The requested resource cannot be found.</span></span> <span data-ttu-id="f783e-218">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-218">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-219">**нотимплементедункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-219">**notImplementedUncategorized**</span></span>            | <span data-ttu-id="f783e-220">Запрошенная функция в настоящее время не реализована.</span><span class="sxs-lookup"><span data-stu-id="f783e-220">The requested feature is not currently implemented.</span></span> <span data-ttu-id="f783e-221">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-221">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-222">**пайлоадтуларжеункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-222">**payloadTooLargeUncategorized**</span></span>              | <span data-ttu-id="f783e-223">Полезные данные запроса превышает предельный размер.</span><span class="sxs-lookup"><span data-stu-id="f783e-223">The request payload exceeds the size limit.</span></span> <span data-ttu-id="f783e-224">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-224">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-225">**ранжеексцеедслимит**</span><span class="sxs-lookup"><span data-stu-id="f783e-225">**rangeExceedsLimit**</span></span>         | <span data-ttu-id="f783e-226">Число ячеек в диапазоне превысило максимальное поддерживаемое число.</span><span class="sxs-lookup"><span data-stu-id="f783e-226">The cell count in range has exceeded the maximum supported number.</span></span> <span data-ttu-id="f783e-227">Клиент Microsoft Graph может попытаться отправить запрос с меньшим размером диапазона.</span><span class="sxs-lookup"><span data-stu-id="f783e-227">The Microsoft Graph client can try to send a request with smaller range size.</span></span>
| <span data-ttu-id="f783e-228">**рекуестабортед**</span><span class="sxs-lookup"><span data-stu-id="f783e-228">**requestAborted**</span></span>         | <span data-ttu-id="f783e-229">Запрос был прерван во время выполнения, который обычно был вызван длительным расчетом времени из функций в книге.</span><span class="sxs-lookup"><span data-stu-id="f783e-229">The request was aborted during run time, which was usually caused by long time calculation from functions in the workbook.</span></span> <span data-ttu-id="f783e-230">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-230">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-231">**сервицеунаваилаблеункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-231">**serviceUnavailableUncategorized**</span></span>      | <span data-ttu-id="f783e-232">Служба временно недоступна или перегружена.</span><span class="sxs-lookup"><span data-stu-id="f783e-232">The service is temporarily unavailable or is overloaded.</span></span> <span data-ttu-id="f783e-233">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса до тех пор, пока не будет пройдена Указанная длительность кулдовн.</span><span class="sxs-lookup"><span data-stu-id="f783e-233">The Microsoft Graph client is not expected to resend the failed request until the specified cooldown duration passes.</span></span>
| <span data-ttu-id="f783e-234">**туманирекуестсункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-234">**tooManyRequestsUncategorized**</span></span>             | <span data-ttu-id="f783e-235">Неудачный запрос превышает определенную частоту.</span><span class="sxs-lookup"><span data-stu-id="f783e-235">The failed request exceeds certain frequency limitation.</span></span> <span data-ttu-id="f783e-236">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса до тех пор, пока не будет пройдена Указанная длительность кулдовн.</span><span class="sxs-lookup"><span data-stu-id="f783e-236">The Microsoft Graph client is not expected to resend the failed request until the specified cooldown duration passes.</span></span>
| <span data-ttu-id="f783e-237">**трансиентфаилуре**</span><span class="sxs-lookup"><span data-stu-id="f783e-237">**transientFailure**</span></span>           | <span data-ttu-id="f783e-238">Не удалось выполнить запрос из-за временной ошибки.</span><span class="sxs-lookup"><span data-stu-id="f783e-238">The request failed due to a transient error.</span></span> <span data-ttu-id="f783e-239">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса до тех пор, пока не будет пройдена Указанная длительность кулдовн.</span><span class="sxs-lookup"><span data-stu-id="f783e-239">The Microsoft Graph client is not expected to resend the failed request until the specified cooldown duration passes.</span></span>
| <span data-ttu-id="f783e-240">**унаусоризедункатегоризед**</span><span class="sxs-lookup"><span data-stu-id="f783e-240">**unauthorizedUncategorized**</span></span>         | <span data-ttu-id="f783e-241">Необходимые сведения для проверки подлинности для ресурса отсутствуют или не являются допустимыми.</span><span class="sxs-lookup"><span data-stu-id="f783e-241">Required authentication information for the resource is either missing or invalid.</span></span> <span data-ttu-id="f783e-242">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-242">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-243">**унсуппортедоператион**</span><span class="sxs-lookup"><span data-stu-id="f783e-243">**unsupportedOperation**</span></span>         | <span data-ttu-id="f783e-244">Выполняемая операция не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="f783e-244">The operation being attempted is not supported.</span></span> <span data-ttu-id="f783e-245">Клиент Microsoft Graph не ожидал повторной отправки невыполненного запроса.</span><span class="sxs-lookup"><span data-stu-id="f783e-245">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="f783e-246">**унсуппортедворкбук**</span><span class="sxs-lookup"><span data-stu-id="f783e-246">**unsupportedWorkbook**</span></span>         | <span data-ttu-id="f783e-247">Не удалось выполнить запрос.</span><span class="sxs-lookup"><span data-stu-id="f783e-247">The request failed.</span></span> <span data-ttu-id="f783e-248">Книга содержит неподдерживаемые функции или превышает предельный размер.</span><span class="sxs-lookup"><span data-stu-id="f783e-248">The workbook contains unsupported features or exceeds the size limit.</span></span> <span data-ttu-id="f783e-249">Клиент Microsoft Graph не должен повторно отправлять неподдерживаемый запрос, пока не будут удалены неподдерживаемые факторы.</span><span class="sxs-lookup"><span data-stu-id="f783e-249">The Microsoft Graph client is not expected to resend the failed request until the unsupported factors are removed.</span></span>

><span data-ttu-id="f783e-250">**Примечание:** Для обычного шаблона неудачный запрос определяется как запрос, соответствующий ответу.</span><span class="sxs-lookup"><span data-stu-id="f783e-250">**Note:** For the regular pattern, the failed request is defined as the request corresponding to the response.</span></span> <span data-ttu-id="f783e-251">Для долгосрочной операции выполняется запрос, который запускает неудачную операцию.</span><span class="sxs-lookup"><span data-stu-id="f783e-251">For the long-running operation pattern, the failed request is the one that triggers the failed operation.</span></span>

### <a name="3-parse-the-top-level-error-code"></a><span data-ttu-id="f783e-252">3. Проанализируйте код ошибки верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="f783e-252">3. Parse the top-level error code</span></span>

<span data-ttu-id="f783e-253">Если вы не можете найти код ошибки второго уровня, указанный в разделе [Detailed Codes Errors](workbook-error-codes.md#detailed-error-code) , рекомендуется выполнить инструкции, приведенные для ошибок верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="f783e-253">If you can't find the second-level error code listed in the [Detailed error codes](workbook-error-codes.md#detailed-error-code) topic, we recommend that you follow the instructions provided for top-level errors.</span></span> <span data-ttu-id="f783e-254">Коды ошибок верхнего уровня привязаны к коду состояния, и вы можете выполнить действия в соответствии с соответствующими кодами состояния.</span><span class="sxs-lookup"><span data-stu-id="f783e-254">The top-level error codes are bound to the status code and you can take action according to the corresponding status codes.</span></span> <span data-ttu-id="f783e-255">Подробные сведения о кодах ошибок и сообщениях об ошибках верхнего уровня приведены в статье [коды ошибок](workbook-error-codes.md#error-code).</span><span class="sxs-lookup"><span data-stu-id="f783e-255">For details about top-level error codes and messages, see [Error codes](workbook-error-codes.md#error-code).</span></span>

### <a name="4-parse-the-status-code"></a><span data-ttu-id="f783e-256">4. анализ кода состояния</span><span class="sxs-lookup"><span data-stu-id="f783e-256">4. Parse the status code</span></span>

<span data-ttu-id="f783e-257">Если код ошибки отсутствует в списке второго уровня или списке верхнего уровня, рекомендуется выполнить действия в соответствии с кодом состояния HTTP.</span><span class="sxs-lookup"><span data-stu-id="f783e-257">If the error code you encounter is not in the second-level list or the top-level list, we recommend that you take action according to the HTTP status code.</span></span>

### <a name="5-error-recovery-cooldown"></a><span data-ttu-id="f783e-258">5. кулдовн восстановления с ошибками</span><span class="sxs-lookup"><span data-stu-id="f783e-258">5. Error recovery cooldown</span></span>

<span data-ttu-id="f783e-259">Для некоторых ответов в стандартном шаблоне продолжительность восстановления кулдовн в секундах может быть предоставлена через `Retry-After` заголовок.</span><span class="sxs-lookup"><span data-stu-id="f783e-259">For some of the responses in the regular pattern, a recovery cooldown duration in seconds might be provided via a `Retry-After` header.</span></span> <span data-ttu-id="f783e-260">При наличии длительности восстановления кулдовн клиент Microsoft Graph не ожидает, что запросы на появление запросов не будут отправляться в течение указанного периода.</span><span class="sxs-lookup"><span data-stu-id="f783e-260">When a recovery cooldown duration is present, the Microsoft Graph client is not expected to send any followup requests before the specified duration passes.</span></span>

## <a name="special-case-handling"></a><span data-ttu-id="f783e-261">Особая обработка обращений</span><span class="sxs-lookup"><span data-stu-id="f783e-261">Special case handling</span></span>

<span data-ttu-id="f783e-262">Для [запросов с сеансом](excel-manage-sessions.md#request-types)при возникновении `502/badGateway` ошибки или `503/serviceUnavailable` ошибки, если код ошибки второго уровня указан в [подробных кодах ошибок](workbook-error-codes.md#detailed-error-code), проанализируйте код второго уровня и выполните соответствующие инструкции; в противном случае мы реконмменд, что вы повторно создаете сеанс напрямую.</span><span class="sxs-lookup"><span data-stu-id="f783e-262">For [sessionful requests](excel-manage-sessions.md#request-types), if you encounter a `502/badGateway` or `503/serviceUnavailable` error, when a second-level error code is listed in [Detailed error codes](workbook-error-codes.md#detailed-error-code), parse the second-level code and follow the corresponding instructions; otherwise, we reconmmend that you recreate the session directly.</span></span>
<!-- {
  "type": "#page.annotation",
  "description": "Error handling in Excel Graph.",
  "keywords": "error response, error object, error codes, innerError, error handling",
  "section": "documentation",
  "tocPath": ""
} -->

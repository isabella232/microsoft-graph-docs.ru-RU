---
title: Руководство по регулированию Microsoft Graph
description: Регулирование позволяет ограничить количество одновременных вызовов службы, чтобы предотвратить перегрузку ресурсов. Служба Microsoft Graph предназначена для обработки большого количества запросов. Регулирование помогает поддерживать оптимальную производительность и надежность службы Microsoft Graph, если выполняется слишком много запросов.
author: piotrci
localization_priority: Priority
ms.openlocfilehash: 8b3b8c5b0ec5a5209ad96f87dc677f4331c24e0b
ms.sourcegitcommit: d2b3ca32602ffa76cc7925d7f4d1e2258e611ea5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/11/2019
ms.locfileid: "27812645"
---
# <a name="microsoft-graph-throttling-guidance"></a>Руководство по регулированию Microsoft Graph


Регулирование позволяет ограничить количество одновременных вызовов службы, чтобы предотвратить перегрузку ресурсов. Служба Microsoft Graph предназначена для обработки большого количества запросов. Регулирование помогает поддерживать оптимальную производительность и надежность службы Microsoft Graph, если выполняется слишком много запросов.

Ограничения регулирования зависят от сценария. Например, при выполнении большого количества операций записи вероятность того, что понадобится регулирование, выше, чем при выполнении только операций чтения.

## <a name="what-happens-when-throttling-occurs"></a>Что происходит при регулировании?

При превышении порогового значения регулирования Microsoft Graph на некоторое время запрещает все последующие запросы от этого клиента. В случае регулирования Microsoft Graph возвращает код состояния HTTP 429 (слишком много запросов), а запросы завершаются ошибкой. Рекомендуемое время ожидания возвращается в заголовке отклика на невыполненный запрос. Поведение регулирования зависит от типа и количества запросов. Например, при большом количестве запросов будут регулироваться запросы всех типов. Пороговые значения ограничений зависят от типа запроса. Могут возникать ситуации, в которых запросы на запись регулируются, а запросы на чтение разрешаются. 

## <a name="common-throttling-scenarios"></a>Распространенные сценарии регулирования

Наиболее распространенные причины регулирования клиентов:

* большое количество запросов во всех приложениях клиента;
* большое количество запросов из конкретного приложения всех клиентов.

## <a name="best-practices-to-handle-throttling"></a>Рекомендации по работе с регулированием

Ниже приведены рекомендации по работе с регулированием.

* Сократите число операций каждого запроса.
* Сократите частоту вызовов.
* Избегайте немедленных повторов, так как запросы накапливаются, и их количество превышает ограничения использования.

Во время реализации обработки ошибок можно обнаружить регулирование с помощью кода ошибки HTTP 429. Неудачный отклик содержит в заголовке поле *Retry-After*. Самый быстрый способ отключить регулирование — применить к запросам задержку *Retry-After*, так как Microsoft Graph продолжает регистрировать в журнале использование ресурсов при регулировании клиента.

1. Подождите столько секунд, сколько указано в поле *Retry-After*.
2. Повторите запрос.
3. Если запрос снова не удастся и будет получен код ошибки 429, регулирование продолжается. Используйте рекомендуемую задержку Retry-After, затем повторите запрос. Выполняйте эти действия, пока запрос не будет удачно выполнен.

Заголовок Retry-After сейчас доступен для ресурсов, представляющих следующее:
- [пользователь](/graph/api/resources/user?view=graph-rest-1.0);
- [фотография](/graph/api/resources/profilephoto?view=graph-rest-1.0);
- [почта](/graph/api/resources/message?view=graph-rest-1.0);
- [календарь (пользователи и группы)](/graph/api/resources/event?view=graph-rest-1.0);
- [контакт](/graph/api/resources/contact?view=graph-rest-1.0);
- [вложение](/graph/api/resources/attachment?view=graph-rest-1.0);
- [групповые чаты](/graph/api/resources/conversation?view=graph-rest-1.0);
- [люди и социальные медиа](/graph/api/resources/social-overview?view=graph-rest-beta);
- [хранилище (OneDrive)](/graph/api/resources/drive?view=graph-rest-1.0).

Развернутое описание регулирования в Microsoft Cloud см. в [этой статье](https://msdn.microsoft.com/library/office/dn589798.aspx).

---
title: Получение расписания доступности пользователей и ресурсов (предварительная версия)
description: Общим сценарием на рабочем месте или в учебном заведении является просмотр доступности пользователя для собрания или доступности команды, помещения или оборудования в некоторый период времени.
ms.openlocfilehash: 8a2dd9318bdd806c99d525ee41f46d78d1963b47
ms.sourcegitcommit: 334e84b4aed63162bcc31831cffd6d363dafee02
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/29/2018
ms.locfileid: "27092712"
---
# <a name="get-freebusy-schedule-of-users-and-resources-preview"></a>Получение расписания доступности пользователей и ресурсов (предварительная версия)

Общим сценарием на рабочем месте или в учебном заведении является просмотр доступности пользователя для собрания или доступности команды, помещения или оборудования в некоторый период времени.

Действие [getSchedule](/graph/api/calendar-getschedule?view=graph-rest-beta) позволяет получить сведения о доступности одной или нескольких сущностей (пользователей, списков рассылки или ресурсов) для определенного периода времени. 

## <a name="example"></a>Пример

Простой пример поиска расписания доступности коллеги (Алексея) в определенную дату с 9:00 до 18:00 по тихоокеанскому времени:

<!-- {
  "blockType": "ignored",
  "name": "calendar_getSchedule_concept"
}-->
```http
POST https://graph.microsoft.com/beta/me/calendar/getschedule 
Prefer: outlook.timezone="Pacific Standard Time"
Content-Type: application/json

{        
    "Schedules": ["AlexW@contoso.OnMicrosoft.com"],
    "StartTime": {
        "dateTime": "2018-08-06T09:00:00",
        "timeZone": "Pacific Standard Time"
    },
    "EndTime": {
        "dateTime": "2018-08-06T18:00:00",
        "timeZone": "Pacific Standard Time"
    },
    "availabilityViewInterval": "15"
}
```

**getSchedule** возвращает два элемента расписания, соответствующие имеющимся событиям в стандартном календаре Алексея, с указанием времени начала и окончания каждого события и сведений о доступности. Можно считать, что в остальное время Алексей свободен в этом диапазоне дат и времени.

<!-- {
  "blockType": "ignored",
  "truncated": true,
  "@odata.type": "microsoft.graph.scheduleInformation",
  "isCollection": true
} -->
```http
HTTP/1.1 200 OK
Content-type: application/json

{
    "@odata.context":"https://graph.microsoft.com/beta/$metadata#Collection(microsoft.graph.scheduleInformation)",
    "value":[
        {
            "scheduleId":"AlexW@contoso.OnMicrosoft.com",
            "availabilityView":"111111002222222200000000000000000000",
            "scheduleItems":[
                {
                    "isPrivate":false,
                    "status":"Tentative",
                    "start":{
                        "dateTime":"2018-08-06T09:00:00.0000000",
                        "timeZone":"Pacific Standard Time"
                    },
                    "end":{
                        "dateTime":"2018-08-06T10:30:00.0000000",
                        "timeZone":"Pacific Standard Time"
                    }
                },
                {
                    "isPrivate":false,
                    "status":"Busy",
                    "start":{
                        "dateTime":"2018-08-06T11:00:00.0000000",
                        "timeZone":"Pacific Standard Time"
                    },
                    "end":{
                        "dateTime":"2018-08-06T13:00:00.0000000",
                        "timeZone":"Pacific Standard Time"
                    }
                }
            ],
            "workingHours":{
                "daysOfWeek":[
                    "monday",
                    "tuesday",
                    "wednesday",
                    "thursday",
                    "friday"
                ],
                "startTime":"08:00:00.0000000",
                "endTime":"17:00:00.0000000",
                "timeZone":{
                    "@odata.type":"#microsoft.graph.customTimeZone",
                    "bias":480,
                    "name":"Customized Time Zone",
                    "standardOffset":{
                        "time":"02:00:00.0000000",
                        "dayOccurrence":1,
                        "dayOfWeek":"sunday",
                        "month":11,
                        "year":0
                    },
                    "daylightOffset":{
                        "daylightBias":-60,
                        "time":"02:00:00.0000000",
                        "dayOccurrence":2,
                        "dayOfWeek":"sunday",
                        "month":3,
                        "year":0
                    }
                }
            }
        }
    ]
}

```

Кроме расписания доступности и рабочего времени Алексея, **getSchedule** также возвращает свойство **availabilityView**, являющееся объединенным представлением доступности Алексея в этот день. Объединенное представление — это строка, состоящая из интервалов времени, охватывающих этот день, в каждом из которых указывается доступность Алексея с использованием следующего стандарта: 

- `0`= свободен
- `1`= под вопросом
- `2`= занят
- `3`= не на месте
- `4`= работает в другом месте. 

По умолчанию длина каждого интервала времени составляет 30 минут. В этом примере используется свойство **availabilityViewInterval** для изменения интервала времени до 15 минут.

## <a name="how-is-getschedule-different-from-findmeetingtimes"></a>Отличие getSchedule от findMeetingTimes

Действие [findMeetingTimes](/graph/api/user-findmeetingtimes?view=graph-rest-1.0) похоже на **getSchedule** тем, что оба они считывают сведения о доступности и рабочем времени указанных пользователей и ресурсов. Эти два действиями отличаются по нескольким основным моментам.

### <a name="application"></a>Приложение

В действии **findMeetingTimes** применяется определенная бизнес-логика, чтобы предложить время и место собрания, например:

- необязательное или обязательное посещение каждой сущности;
- тип запрошенного действия для времени суток;
- необходимое минимальное присутствие для кворума на собрании.

Оно подходит для сценариев, зависящих от [оптимизации планирования встреч](findmeetingtimes-example.md).

Действие **getSchedule** просто возвращает сведения о доступности с учетом существующих событий в каждом из запрошенных календарей для указанного промежутка времени, и предполагается, что остальное время в этом промежутке является свободным. После этого вы можете применить бизнес-логику, чтобы использовать эти данные для завершения сценария.

### <a name="app-only-support"></a>Поддержка только для приложений

Действие **findmeetingtimes** поддерживает только делегированные сценарии, требующие входа пользователя в приложение. Приложения могут считывать события только в календарях, доступных вошедшему в систему пользователю. К ним могут относится календари, делегированные или предоставленные в совместное использование вошедшему пользователю другими пользователями.

Действие **getSchedule** поддерживает как сценарии делегирования, так и сценарии только для приложений. В последнем случае администратор разрешает приложению получать доступ ко всем календарям без входа пользователя.


### <a name="version-support"></a>Поддержка версии

Действие **findmeetingtimes** общедоступно для всех приложений. 

Действие **getSchedule** в настоящее время доступно [в состоянии предварительной версии](versioning-and-support.md#beta-version) и поэтому не подходит для применения в рабочих приложениях.


## <a name="permissions"></a>Разрешения
Разрешение с минимальным уровнем привилегий, необходимое для получения сведений о доступности, — Calendar.Read. В зависимости от сценария приложения согласие может даваться вошедшим в систему пользователем или администратором.
Кроме сведений о доступности и рабочем времени запрошенных сущностей, **getSchedule** может возвращать тему и место события, если:

- Событие помечено низким уровнем конфиденциальности (`normal` или `personal`) И применяется одно или несколько следующих условий:

- параметры запрошенного календаря пользователя разрешают всем пользователям в организации просматривать названия и расположения;
- к запрошенному календарю предоставлен общий доступ вошедшему в систему пользователю;
- вошедший в систему пользователь является администратором той же организации, что и запрошенный пользователь.

## <a name="time-zone-representation"></a>Представление часового пояса
По умолчанию время начала и окончания возвращаемых элементов расписания отображается в формате UTC. Вы можете использовать заголовок `Prefer`, чтобы указать соответствующий часовой пояс для приложения. Например: 
```
Prefer: outlook.timezone="Pacific Standard Time"
```

## <a name="limits-and-error-conditions"></a>Ограничения и состояния ошибок
Необходимо учитывать следующие ограничения и состояние ошибки:

- **getSchedule** может поддерживать поиск сведений о доступности для 20 сущностей одновременно. Это ограничение относится к количеству пользователей, определенных по отдельности или в качестве участников списка рассылки, а также к количеству ресурсов.
- Период времени для поиска должен быть меньше 42 дней.
- Если действие **getSchedule** не может определить указанного пользователя или ресурс, оно возвращает один элемент расписания и сообщает об ошибке. 

## <a name="see-also"></a>См. также
- [Справочник по разрешениям](permissions-reference.md#calendars-permissions)
- [Поиск времени для проведения собрания в календаре Outlook](findmeetingtimes-example.md)

# <a name="get-freebusy-schedule-of-users-and-resources-preview"></a>Получение графика доступности пользователей и ресурсов (предварительная версия)

На работе или в школе часто возникают ситуации, в которых требуется отобразить информацию о том, свободен ли пользователь для проведения совещания, или получить данные о доступности рабочей группы, помещения или оборудования в определенный период времени.

Действие [getSchedule](../api-reference/beta/api/calendar_getschedule.md) позволяет получить информацию о доступности из одного или нескольких объектов — пользователей, списков рассылки или ресурсов — в течение определенного времени. 

## <a name="example"></a>Пример

Простым примером является получение графика занятости коллеги по имени Алекс, в определенный день, с 9:00 до 18:00 по стандартному тихоокеанскому времени.

<!-- {
  "blockType": "ignored",
  "name": "calendar_getSchedule_concept"
}-->
```http
POST https://graph.microsoft.com/beta/me/calendar/getschedule 
Prefer: outlook.timezone="Pacific Standard Time"
Content-Type: application/json

{        
    "Schedules": ["AlexW@contoso.OnMicrosoft.com"],
    "StartTime": {
        "dateTime": "2018-08-06T09:00:00",
        "timeZone": "Pacific Standard Time"
    },
    "EndTime": {
        "dateTime": "2018-08-06T18:00:00",
        "timeZone": "Pacific Standard Time"
    },
    "availabilityViewInterval": "15"
}
```

**getSchedule** возвращает два элемента графика, которые соответствуют событиям, имеющимся в используемом Алекс по умолчанию календаре, и которые отображают время начала и время завершения каждого из событий, а также сведения о доступности пользователя в ходе каждого из них. Можно предположить, что в оставшееся время, в течение указанного дня и временного диапазона, Алекс будет свободен.

<!-- {
  "blockType": "ignored",
  "truncated": true,
  "@odata.type": "microsoft.graph.scheduleInformation",
  "isCollection": true
} -->
```http
HTTP/1.1 200 OK
Content-type: application/json

{
    "@odata.context":"https://graph.microsoft.com/beta/$metadata#Collection(microsoft.graph.scheduleInformation)",
    "value":[
        {
            "scheduleId":"AlexW@contoso.OnMicrosoft.com",
            "availabilityView":"111111002222222200000000000000000000",
            "scheduleItems":[
                {
                    "isPrivate":false,
                    "status":"Tentative",
                    "start":{
                        "dateTime":"2018-08-06T09:00:00.0000000",
                        "timeZone":"Pacific Standard Time"
                    },
                    "end":{
                        "dateTime":"2018-08-06T10:30:00.0000000",
                        "timeZone":"Pacific Standard Time"
                    }
                },
                {
                    "isPrivate":false,
                    "status":"Busy",
                    "start":{
                        "dateTime":"2018-08-06T11:00:00.0000000",
                        "timeZone":"Pacific Standard Time"
                    },
                    "end":{
                        "dateTime":"2018-08-06T13:00:00.0000000",
                        "timeZone":"Pacific Standard Time"
                    }
                }
            ],
            "workingHours":{
                "daysOfWeek":[
                    "monday",
                    "tuesday",
                    "wednesday",
                    "thursday",
                    "friday"
                ],
                "startTime":"08:00:00.0000000",
                "endTime":"17:00:00.0000000",
                "timeZone":{
                    "@odata.type":"#microsoft.graph.customTimeZone",
                    "bias":480,
                    "name":"Customized Time Zone",
                    "standardOffset":{
                        "time":"02:00:00.0000000",
                        "dayOccurrence":1,
                        "dayOfWeek":"sunday",
                        "month":11,
                        "year":0
                    },
                    "daylightOffset":{
                        "daylightBias":-60,
                        "time":"02:00:00.0000000",
                        "dayOccurrence":2,
                        "dayOfWeek":"sunday",
                        "month":3,
                        "year":0
                    }
                }
            }
        }
    ]
}

```

Помимо сведений о доступности и рабочем времени Алекс **getSchedule** также возвращает **availabilityView** — объединенное представление доступности Алекс в течение этого дня. Объединенное представление — это строка, которая состоит из периодов времени, составляющих указанный день, где для каждого временного интервала указывается доступность Алекс с применением следующих условных обозначений: 

- `0`= свободен
- `1`= под вопросом
- `2`= занят
- `3`= нет на месте
- `4`= работа в другом месте. 

По умолчанию продолжительность каждого периода времени составляет 30 минут. В данном примере для настройки периода времени и установки его продолжительности равной 15 минутам используется свойство **availabilityViewInterval**.

## <a name="how-is-getschedule-different-from-findmeetingtimes"></a>Чем отличается getSchedule от findMeetingTimes

Действия [findMeetingTimes](../api-reference/v1.0/api/user_findmeetingtimes.md) и **getSchedule** похожи тем, что оба они позволяют получить информацию о доступности и рабочем времени указанных пользователей и ресурсов. Тем не менее, эти два действия имеют несколько существенных отличий.

### <a name="application"></a>Приложение

Действие **findMeetingTimes** использует определенную бизнес-логику для предложения времени и места проведения собраний и учитывает, к примеру:

- необязательное или обязательное присутствие каждого лица;
- характер запрашиваемой деятельности для определенного времени суток;
- минимальное количество лиц, присутствующих на совещании, необходимое для обеспечения кворума.

Это подходит для сценариев, которые зависят от[оптимизации определения времени встречи](findmeetingtimes_example.md).

Действие **getSchedule** просто возвращает сведения о доступности событий, указанных в каждом из запрашиваемых календарей для заданного периода времени, и предполагает, что оставшееся время в пределах данного временного интервала остается свободным. Чтобы использовать эти данные для выполнения сценария, необходимо применить дополнительную бизнес-логику.

### <a name="app-only-support"></a>Поддержка только для программ

Действие **findmeetingtimes** поддерживает только делегированные сценарии, требующие от пользователя входа в программу. Программа может считывать события только из тех календарей, которые доступны пользователю, выполнившему вход. В число этих календарей могут входить календари, делегированные другими пользователями, или календари, которые используются совместно с пользователем, вошедшим в систему.

Действие **getSchedule** поддерживает как делегированные сценарии, так и сценарии, предназначенные только для программы. В дальнейшем, администратор может предоставить программе доступ ко всем календарям без пользователя, выполнившего вход.


### <a name="version-support"></a>Поддержка версии

**findmeetingtimes** обычно доступно для всех программ. 

**getSchedule** в настоящее время доступно [в состоянии предварительной версии](versioning_and_support.md#beta-version) и не подходит для использования в производственных приложениях.


## <a name="permissions"></a>Разрешения
Минимальное разрешение, необходимое для получения сведений о доступности, — Calendar.Read. В зависимости от используемого программой сценария оно может предоставляться вошедшим в систему пользователем или администратором.
Помимо сведений о доступности и рабочем времени указанных лиц **getSchedule** может также возвращать данные о характере и местоположении события в случае:

- если событие помечено, как событие с низким уровнем конфиденциальности — `normal` или `personal`, И если удовлетворяется одно или несколько следующих условий.

- Параметры календаря, запрашиваемого пользователем, позволяют всем пользователям в организации просматривать заголовки и сведения о местоположении
- Календарь, запрашиваемый пользователем, используется совместно с пользователем, вошедшим в систему
- Пользователь, выполнивший вход, является администратором в той же организации, в которой работает запрашиваемый пользователь.

## <a name="time-zone-representation"></a>Представление часового пояса
По умолчанию время начала и завершения возвращаемых элементов графика доступности отображается в формате UTC. Чтобы указать часовой пояс, подходящей для вашей программы, можно использовать заоловок `Prefer`. Пример: 
```
Prefer: outlook.timezone="Pacific Standard Time"
```

## <a name="limits-and-error-conditions"></a>Ограничения и состояния ошибки
Принимайте во внимание следующие ограничения и состояния ошибки.

- **getSchedule** может выполнять поиск информации о доступности для 20 объектов единовременно. Это ограничение распространяется на количество пользователей, указанных в индивидуальном порядке, или заданных в качестве членов списка рассылки, а также  на количество ресурсов.
- Период времени, используемый для поиска, должен составлять менее 42 дней.
- Если действие **getSchedule** не может определить указанного пользователя или запрашиваемый ресурс, то оно возвращает один элемент графика и выдает ошибку. 

## <a name="see-also"></a>См. также
- [Справочник по разрешениям](permissions_reference.md#calendars-permissions)
- [Поиск времени для проведения собрания в календаре Outlook](findmeetingtimes_example.md)

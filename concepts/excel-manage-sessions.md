---
title: Управление сеансами и хранением данных в Excel с помощью Microsoft Graph
description: Если приложению нужно вызывать API Excel более одного или двух раз, необходимо создать сеанс и передавать его ИД с каждым запросом. Наличие ИД сеанса в запросах гарантирует максимально эффективное использование API Excel.
localization_priority: Normal
author: lumine2008
ms.prod: excel
ms.openlocfilehash: 151119a2a2861b64db126c8f49d0b916a6f563e8
ms.sourcegitcommit: 0ce657622f42c510a104156a96bf1f1f040bc1cd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/24/2019
ms.locfileid: "32526267"
---
# <a name="manage-sessions-and-persistence-in-excel-with-microsoft-graph"></a>Управление сеансами и хранением данных в Excel с помощью Microsoft Graph

Если приложению нужно вызывать API Excel более одного или двух раз, необходимо создать сеанс и передавать его ИД с каждым запросом. Наличие ИД сеанса в запросах гарантирует максимально эффективное использование API Excel.

API Excel вызываются в одном из трех режимов:

1. **Сохраняемый сеанс** — все изменения, внесенные в книгу, сохраняются в ней. Это наиболее эффективный и производительный способ использования API Excel.
2. **Временный сеанс** — изменения, внесенные интерфейсом API, не сохраняются в исходном расположении. Вместо этого внутренний сервер Excel сохраняет временную копию файла, в которой отражены изменения, внесенные во время конкретного сеанса API. Когда истечет срок действия сеанса Excel, изменения будут потеряны. Этот режим удобен для приложений, которым нужно выполнять анализ или получать результаты вычислений или изображение диаграммы, не меняя состояние документа.
3. **Без сеансов** — в вызовах API не передается ИД сеанса. Серверам Excel необходимо находить собственную копию книги для каждой операции. Этот способ вызова API Excel неэффективен, но подходит для отправки некоторых изолированных запросов.

Чтобы представить сеанс в API, используйте заголовок `workbook-session-id: {session-id}`.

>**Примечание.** Заголовок сеанса не является обязательным для работы API Excel. Тем не менее мы рекомендуем использовать заголовок сеанса для повышения производительности. Если вы не используете заголовок сеанса, изменения, внесенные во время вызова API _сохраняются_ в файл.  

## <a name="next-step"></a>Дальнейшие действия
Сведения о том, как создавать и использовать сеансы, см. в [справочной статье о создании сеанса](/graph/api/workbook-createsession?view=graph-rest-1.0).

## <a name="see-also"></a>См. также
* [Запись в книгу Excel с помощью Microsoft Graph](excel-write-to-workbook.md)
* [Использование функций книг в Excel с помощью Microsoft Graph](excel-use-functions.md)
* [Обновление формата диапазона в Excel с помощью Microsoft Graph](excel-update-range-format.md)
* [Показ изображения диаграммы в Excel с помощью Microsoft Graph](excel-display-chart-image.md)
* [Использование REST API для Excel](/graph/api/resources/excel?view=graph-rest-1.0)

---
title: Управление сеансами и хранением данных в Excel с помощью Microsoft Graph
description: Если приложению нужно вызывать API Excel более одного или двух раз, необходимо создать сеанс и передавать его ИД с каждым запросом. Наличие ИД сеанса в запросах гарантирует максимально эффективное использование API Excel.
ms.openlocfilehash: 6fe869aaab62b47934c91194eeb75229d8215e9a
ms.sourcegitcommit: 334e84b4aed63162bcc31831cffd6d363dafee02
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/29/2018
ms.locfileid: "27092579"
---
# <a name="manage-sessions-and-persistence-in-excel-with-microsoft-graph"></a><span data-ttu-id="0c3bc-104">Управление сеансами и хранением данных в Excel с помощью Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="0c3bc-104">Manage sessions and persistence in Excel with Microsoft Graph</span></span>

<span data-ttu-id="0c3bc-105">Если приложению нужно вызывать API Excel более одного или двух раз, необходимо создать сеанс и передавать его ИД с каждым запросом.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-105">If your application needs to make more than one or two calls to the Excel API, you should create a session and pass the session Id with each request.</span></span> <span data-ttu-id="0c3bc-106">Наличие ИД сеанса в запросах гарантирует максимально эффективное использование API Excel.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-106">The presence of a session Id in the requests ensures that you are using the Excel API in the most efficient way possible.</span></span>

<span data-ttu-id="0c3bc-107">API Excel вызываются в одном из трех режимов:</span><span class="sxs-lookup"><span data-stu-id="0c3bc-107">Excel APIs are called in one of three modes:</span></span>

1. <span data-ttu-id="0c3bc-108">**Сохраняемый сеанс** — все изменения, внесенные в книгу, сохраняются в ней.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-108">**Persistent session**  All changes made to the workbook are persisted (saved) to the workbook.</span></span> <span data-ttu-id="0c3bc-109">Это наиболее эффективный и производительный способ использования API Excel.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-109">This is the most efficient and best-performing way to use the Excel API.</span></span>
2. <span data-ttu-id="0c3bc-110">**Временный сеанс** — изменения, внесенные интерфейсом API, не сохраняются в исходном расположении.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-110">**Non-persistent session**  Changes made by the API are not saved to the source location.</span></span> <span data-ttu-id="0c3bc-111">Вместо этого внутренний сервер Excel сохраняет временную копию файла, в которой отражены изменения, внесенные во время конкретного сеанса API.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-111">Instead, the Excel backend server keeps a temporary copy of the file that reflects the changes made during that particular API session.</span></span> <span data-ttu-id="0c3bc-112">Когда истечет срок действия сеанса Excel, изменения будут потеряны.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-112">When the Excel session expires, the changes are lost.</span></span> <span data-ttu-id="0c3bc-113">Этот режим удобен для приложений, которым нужно выполнять анализ или получать результаты вычислений или изображение диаграммы, не меняя состояние документа.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-113">This mode is useful for apps that need to do analysis or obtain the results of a calculation or a chart image, but do not need to affect the document state.</span></span>
3. <span data-ttu-id="0c3bc-114">**Без сеансов** — в вызовах API не передается ИД сеанса. Серверам Excel необходимо находить собственную копию книги для каждой операции.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-114">**Sessionless**  The API calls do not pass a session Id. The Excel servers have to locate the server's copy of the workbook for each operation.</span></span> <span data-ttu-id="0c3bc-115">Этот способ вызова API Excel неэффективен, но подходит для отправки некоторых изолированных запросов.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-115">This is not an efficient way to call the Excel API, but it is suitable for making certain types of isolated requests.</span></span>

<span data-ttu-id="0c3bc-116">Чтобы представить сеанс в API, используйте заголовок `workbook-session-id: {session-id}`.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-116">To represent the session in the API, use the `workbook-session-id: {session-id}` header.</span></span>

><span data-ttu-id="0c3bc-p106">**Примечание.** Заголовок сеанса не является обязательным для работы API Excel. Тем не менее мы рекомендуем использовать заголовок сеанса для повышения производительности. Если вы не используете заголовок сеанса, изменения, внесенные во время вызова API _сохраняются_ в файл.</span><span class="sxs-lookup"><span data-stu-id="0c3bc-p106">**Note:** The session header is not required for an Excel API to work. However, we recommend that you use the session header to improve performance. If you don't use a session header, changes made during the API call _are_ persisted to the file.</span></span>  

## <a name="next-step"></a><span data-ttu-id="0c3bc-120">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="0c3bc-120">Next step</span></span>
<span data-ttu-id="0c3bc-121">Сведения о том, как создавать и использовать сеансы, см. в [справочной статье о создании сеанса](/graph/api/workbook-createsession?view=graph-rest-1.0).</span><span class="sxs-lookup"><span data-stu-id="0c3bc-121">To learn how to create and use sessions, see the [Create session reference topic](/graph/api/workbook-createsession?view=graph-rest-1.0).</span></span>

## <a name="see-also"></a><span data-ttu-id="0c3bc-122">См. также</span><span class="sxs-lookup"><span data-stu-id="0c3bc-122">See also</span></span>
* [<span data-ttu-id="0c3bc-123">Запись в книгу Excel с помощью Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="0c3bc-123">Write to an Excel workbook using Microsoft Graph</span></span>](excel-write-to-workbook.md)
* [<span data-ttu-id="0c3bc-124">Использование функций книг в Excel с помощью Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="0c3bc-124">Use workbook functions in Excel with Microsoft Graph</span></span>](excel-use-functions.md)
* [<span data-ttu-id="0c3bc-125">Обновление формата диапазона в Excel с помощью Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="0c3bc-125">Update a range’s format in Excel with Microsoft Graph</span></span>](excel-update-range-format.md)
* [<span data-ttu-id="0c3bc-126">Показ изображения диаграммы в Excel с помощью Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="0c3bc-126">Display a chart image in Excel with Microsoft Graph</span></span>](excel-display-chart-image.md)
* [<span data-ttu-id="0c3bc-127">Использование REST API для Excel</span><span class="sxs-lookup"><span data-stu-id="0c3bc-127">Use the Excel REST API</span></span>](/graph/api/resources/excel?view=graph-rest-1.0)

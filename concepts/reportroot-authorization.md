---
title: Авторизация для API с целью чтения отчетов об использовании Microsoft 365
description: Данные отчетов, доступные через API отчетов Microsoft Graph, являются конфиденциальными и защищаются как разрешениями, так и ролями Azure Active Directory (Azure AD).
author: kszb
localization_priority: Priority
ms.prod: reports
ms.openlocfilehash: 2830a3ad66f123418712aac214dd30be8227ca90
ms.sourcegitcommit: a6d284b3726139f11194aa3d23b8bb79165cc09e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "46810946"
---
# <a name="authorization-for-apis-to-read-microsoft-365-usage-reports"></a><span data-ttu-id="82b55-103">Авторизация для API с целью чтения отчетов об использовании Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="82b55-103">Authorization for APIs to read Microsoft 365 usage reports</span></span>

<span data-ttu-id="82b55-104">Данные отчетов, доступные через API отчетов Microsoft Graph, являются конфиденциальными.</span><span class="sxs-lookup"><span data-stu-id="82b55-104">Report data accessible via the Microsoft Graph reports API is sensitive.</span></span> <span data-ttu-id="82b55-105">В частности, отчеты об использовании Microsoft 365 защищаются как разрешениями, так и ролями Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="82b55-105">In particular, Microsoft 365 usage reports are protected by both permissions and Azure Active Directory (Azure AD) roles.</span></span> <span data-ttu-id="82b55-106">Сведения этой статьи относятся к API-интерфейсу отчетов, считывающему отчеты об использовании Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="82b55-106">The information in this article applies to the reports API that reads Microsoft 365 usage reports.</span></span>

<span data-ttu-id="82b55-107">API для чтения отчетов об использовании Microsoft 365 поддерживают два типа авторизации:</span><span class="sxs-lookup"><span data-stu-id="82b55-107">The APIs to read Microsoft 365 usage reports support two types of authorization:</span></span>

- <span data-ttu-id="82b55-108">**Авторизация на уровне приложения**. Позволяет приложению читать все отчеты об использовании без необходимости входа пользователя.</span><span class="sxs-lookup"><span data-stu-id="82b55-108">**Application-level authorization** - Allows an app to read all service usage reports without a signed-in user.</span></span> <span data-ttu-id="82b55-109">Разрешения, предоставленные приложению, определяют авторизацию.</span><span class="sxs-lookup"><span data-stu-id="82b55-109">The permissions granted to the application determine authorization.</span></span>
- <span data-ttu-id="82b55-110">**Авторизация, делегированная пользователю**. Позволяет приложению читать все отчеты об использовании служб от имени вошедшего пользователя.</span><span class="sxs-lookup"><span data-stu-id="82b55-110">**User delegated authorization** - Allows an app to read all service usage reports on behalf of the signed-in user.</span></span> <span data-ttu-id="82b55-111">Помимо предоставления необходимых разрешений приложению, пользователь должен быть участником с ролью ограниченного администратора Azure AD.</span><span class="sxs-lookup"><span data-stu-id="82b55-111">In addition to the app having been granted the required permissions, the user must be a member of an Azure AD limited administrator role.</span></span> <span data-ttu-id="82b55-112">Это может быть одна из следующих ролей: администратор компании, администратор Exchange, администратор SharePoint, администратор Lync, администратор службы команд, администратор связи команд, глобальный читатель или читатель отчетов.</span><span class="sxs-lookup"><span data-stu-id="82b55-112">This can be one of the following roles: company administrator, Exchange administrator, SharePoint administrator, Lync administrator, Teams Service Administrator, Teams Communications Administrator, global reader, or reports reader.</span></span>

<span data-ttu-id="82b55-113">При вызове API из песочницы Graph:</span><span class="sxs-lookup"><span data-stu-id="82b55-113">If you're calling the APIs from Graph Explorer:</span></span>

- <span data-ttu-id="82b55-114">Администратор клиента Azure AD должен явным образом предоставить согласие на требуемые разрешения для приложения песочницы Graph.</span><span class="sxs-lookup"><span data-stu-id="82b55-114">The Azure AD tenant administrator must explicitly grant consent for the requested permissions to the Graph Explorer application.</span></span>
- <span data-ttu-id="82b55-115">Пользователь должен быть участником с ролью ограниченного администратора в Azure AD, указанной выше для авторизации, делегированной пользователю.</span><span class="sxs-lookup"><span data-stu-id="82b55-115">The user must be a member of a limited administrator role in Azure AD, listed above for user-delegated authorization.</span></span>

><span data-ttu-id="82b55-116">**Примечание.** Песочница Graph не поддерживает авторизацию на уровне приложения.</span><span class="sxs-lookup"><span data-stu-id="82b55-116">**Note**: Graph Explorer does not support application-level authorization.</span></span>

<span data-ttu-id="82b55-117">При вызове API из приложения:</span><span class="sxs-lookup"><span data-stu-id="82b55-117">If you're calling the APIs from an application:</span></span>

- <span data-ttu-id="82b55-118">Администратор клиента Azure AD должен явным образом предоставить разрешение для вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="82b55-118">The Azure AD tenant administrator must explicitly grant consent to your application.</span></span> <span data-ttu-id="82b55-119">Это необходимо как для авторизации на уровне приложения, так и для авторизации, делегированной пользователю.</span><span class="sxs-lookup"><span data-stu-id="82b55-119">This is required both for application-level authorization and user delegated authorization.</span></span>
- <span data-ttu-id="82b55-120">При использовании авторизации, делегированной пользователю, вошедший пользователь должен быть участником с ролью ограниченного администратора в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="82b55-120">If you're using user delegated authorization, the signed-in user must be a member of a limited administrator role in Azure AD.</span></span>

## <a name="assign-azure-ad-roles-to-users"></a><span data-ttu-id="82b55-121">Назначение ролей Azure AD для пользователей</span><span class="sxs-lookup"><span data-stu-id="82b55-121">Assign Azure AD roles to users</span></span>

<span data-ttu-id="82b55-122">После получения приложением разрешений все обладатели доступа к приложению (т. е. участники клиента Azure AD) получат предоставленные разрешения.</span><span class="sxs-lookup"><span data-stu-id="82b55-122">After an application is granted permissions, everyone with access to the application (that is, members of the Azure AD tenant) receives the granted permissions.</span></span> <span data-ttu-id="82b55-123">Чтобы обеспечить дополнительную защиту конфиденциальных данных отчетов, администраторы клиента должны назначить пользователям приложения соответствующие роли Azure AD.</span><span class="sxs-lookup"><span data-stu-id="82b55-123">To further protect sensitive reports data, tenant administrators must assign users of the application the appropriate Azure AD roles.</span></span> <span data-ttu-id="82b55-124">Подробности см. в статьях [Разрешения роли администратора в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-assign-admin-roles-azure-portal) и [Назначение ролей администратора и других ролей пользователям с помощью Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-users-assign-role-azure-portal).</span><span class="sxs-lookup"><span data-stu-id="82b55-124">For details, see [Administrator role permissions in Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-assign-admin-roles-azure-portal) and [Assign administrator and non-administrator roles to users with Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-users-assign-role-azure-portal).</span></span>

><span data-ttu-id="82b55-125">**Примечание.** Вы должны быть администратором клиента, чтобы выполнить это действие.</span><span class="sxs-lookup"><span data-stu-id="82b55-125">**Note:** You must be a tenant administrator to perform this step.</span></span>

<span data-ttu-id="82b55-126">Назначение роли пользователю:</span><span class="sxs-lookup"><span data-stu-id="82b55-126">To assign a role to a user:</span></span>

1. <span data-ttu-id="82b55-127">Войдите на [портал Azure](https://portal.azure.com) (https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="82b55-127">Sign in to the [Azure portal](https://portal.azure.com) (https://portal.azure.com).</span></span>
2. <span data-ttu-id="82b55-128">Щелкните значок в левом верхнем углу, чтобы развернуть меню портала Azure.</span><span class="sxs-lookup"><span data-stu-id="82b55-128">Click the icon in the top left to expand the Azure portal menu.</span></span> <span data-ttu-id="82b55-129">Выберите **Azure Active Directory** > **Пользователи**.</span><span class="sxs-lookup"><span data-stu-id="82b55-129">Select **Azure Active Directory** > **Users**.</span></span>
3. <span data-ttu-id="82b55-130">Щелкните имя пользователя.</span><span class="sxs-lookup"><span data-stu-id="82b55-130">Click the name of the user.</span></span>
4. <span data-ttu-id="82b55-131">Выберите **Назначенные роли**, затем **Добавление назначения**.</span><span class="sxs-lookup"><span data-stu-id="82b55-131">Choose **Assigned roles**, and then **Add assignment**.</span></span>
5. <span data-ttu-id="82b55-132">Выберите соответствующую роль и нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="82b55-132">Select the appropriate role, and click **Add**.</span></span>

---
title: Различия между функциями Azure AD Graph и Microsoft Graph
description: Описание различий между функциями API Azure Active Directory (Azure AD) и API Microsoft Graph, которые помогут быстро и легко перенести приложения.
author: dkershaw10
localization_priority: Normal
ms.prod: azure-active-directory
ms.openlocfilehash: 34cbf88ed5fc1f6fe2cba9df3fdb0167630d120e
ms.sourcegitcommit: ef47b165f7a140cfc0309a275cb8722dd265660d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/25/2020
ms.locfileid: "46872931"
---
# <a name="feature-differences-between-azure-ad-graph-and-microsoft-graph"></a>Различия между функциями Azure AD Graph и Microsoft Graph

Эта статья входит в *Шаг 1: Ознакомьтесь с различиями* в API [процесса переноса приложений](migrate-azure-ad-graph-planning-checklist.md).

Многие функции Microsoft Graph работают аналогично своим аналогам в Azure AD Graph. Однако некоторые изменения и/или улучшены. Здесь вы узнаете, как адаптировать ваши приложения, чтобы воспользоваться преимуществами этих различий.  Часто изменения являются незначительными, но хорошо подходят.

В этой статье рассказывается, как обрабатываются Microsoft Graph:

- Расширения схемы каталога
- Разностные запросы
- Пакетная обработка

## <a name="directory-schema-extensions"></a>Расширения схемы каталога

Если ваше приложение использует расширения каталогов Azure AD Graph, вы можете продолжать использовать одни и те же базовые API (с URL-адресами запросов Microsoft Graph):

- Управление определениями свойств расширения с помощью свойства **екстенсионпропертиес** в ресурсе [Application] [/граф/АПИ/ресаурцес/аппликатион? View = Graph-REST-v 1.0).
- Получите доступные свойства расширения с помощью действия [жетаваилабликстенсионпропертиес](/graph/api/directoryobject-getavailableextensionproperties?view=graph-rest-v1.0) .
- Считывание значений расширений с помощью GET и `$select`
- Поиск по значениям расширений с помощью GET и `$filter`
- Обновление значений расширений с помощью PATCH
- Удаление значений расширений с помощью PATCH (устанавливается в **значение NULL**)

Microsoft Graph предоставляет расширенные возможности для разработчиков расширений схемы, которые в настоящее время не совместимы с расширениями каталогов Azure AD Graph. Чтобы узнать больше, ознакомьтесь с разрешениями [в разделе Добавление пользовательских данных в расширениях схемы](/graph/extensibility-overview#schema-extensions).

### <a name="recommended-migration-approach"></a>Рекомендуемый подход к миграции

Если приложение Azure AD Graph использует расширения каталогов, выполните добавочный подход к переносу приложения в Microsoft Graph.

Сначала переключите приложение на использование вызовов API Microsoft Graph, но позвольте приложению продолжить использовать расширения каталогов Azure AD Graph.

Затем можно переключиться на использование расширений схемы Microsoft Graph. В некоторых случаях переключение не будет подходящимся. Не переключать, если:

- Ваше приложение использует расширения каталогов, созданные с помощью AD Connect
- Ваше приложение устанавливает значения расширений каталогов, которые используются в утверждениях маркеров другими приложениями
- Ваше приложение устанавливает значения расширений каталогов, которые используются в правилах динамического членства 

>**Примечание**. Использование свойств расширения схемы Microsoft Graph в качестве утверждений в маркере с использованием необязательных утверждений или в динамическом правиле членства пока не поддерживается.

Чтобы перейти к новой модели расширения схемы Microsoft Graph, необходимо выполнить следующие действия:

- Определение новых определений расширений схемы с помощью Microsoft Graph.
- Обновите приложение, чтобы обеспечить поддержку новых определений расширений схемы.
- Перенесите данные из свойств расширения схемы Azure AD в новые свойства расширения схемы Microsoft Graph.  Автоматическая миграция данных не поддерживается.

## <a name="differential-queries"></a>Разностные запросы

Azure AD Graph и Microsoft Graph позволяют отслеживать изменения с помощью запросов.  Высокоуровневый подход похож на два API, но синтаксис отличается.

Graph Azure AD вызывает эти разностные запросы.  В Microsoft Graph они являются [разностными запросами](/graph/delta-query-overview).

В следующей таблице представлены основные сходства и различия:

|Запрос Delta |Azure AD Graph | Microsoft Graph |
|----|----|----|
| _Первоначальный запрос данных_ | Использует параметр запроса:<br>`GET /groups?deltaLink=` | Использует функцию: <br> `GET /groups/delta` |
| _Получение новых изменений_ | `GET /groups?deltaLink={deltaToken}` | `GET /groups/delta?$deltaToken={deltaToken}` |
| _Синхронизация в данный момент_ |Использует настраиваемый заголовок HTTP:<br> `ocp-aad-dq-include-only-delta-token: true` | Использует параметр запроса: <br> `GET /groups/delta?$deltaToken=latest` |
| _Отслеживание изменений для Директорйобжектс_ | Возвращает изменения для нескольких ресурсов (пользователей и групп) в одной и той же операции:&nbsp;&nbsp;<br> `GET /directoryObject?$filter=isof('User') or isof('Group')&deltaLink=` | Использует отдельные запросы в Microsoft Graph, по одному для каждого ресурса. |
| _Получение изменений ресурсов и связей_ | Все запросы возвращают изменения ресурсов и связей, если у ресурса есть связи. | `GET /groups/delta?$expand=members` |
| _Ответ, указывающий на новые и измененные элементы_ | <ul><li><p>Представляет новые экземпляры, созданные в стандартном представлении.</p></li><li><p>Обновленные экземпляры представлены по их идентификатору, *по крайней мере* , к свойствам, которые были обновлены. Могут быть включены и другие свойства.</p></li><li><p>Отношения представлены в виде `directoryLinkChange` типа.</p></li></ul>|<ul><li><p>Представляет новые экземпляры, созданные в стандартном представлении.</p></li><li><p>Обновленные экземпляры представлены по их идентификатору, *по крайней мере* , к свойствам, которые были обновлены. Могут быть включены и другие свойства.</p></li><li><p>Связи представлены в виде аннотаций в стандартном представлении ресурсов. В этих заметках используется формат `propertyName@delta` , например `members@delta` для изменения членства в группе.</p></li></ul> |
| _Ответ, указывающий на удаленные элементы_| Указывает удаленному элементу с дополнительным свойством AAD. для свойства "с *удалением* " значение true. | Указывает удаленный элемент с \@ удаленной заметкой. Он также может содержать код причины, указывающий на то, что элемент удален, но его можно восстановить или удалить без возможности восстановления. |

Если ваше приложение уже сохраняет данные о состоянии, рассмотрите возможность использования параметра "Синхронизация из", показанного ранее, для управления переходом на запросы разности.

## <a name="batching"></a>Пакетная обработка

Azure AD Graph использовал систему, называемую многокомпонентными сообщениями MIME, для управления пакетной.  Microsoft Graph использует [пакетную обработку JSON](json-batching.md) , чтобы разрешить до 20 запросов в одной пакетной операции. Механизм пакетной обработки JSON значительно проще использовать, особенно вместе с библиотеками синтаксического анализа JSON.  Он также позволяет выполнять виртуализацию пакетных операций.  Однако это не совместимо с пакетным способом пакетной обработки графа Azure AD.

## <a name="next-steps"></a>Дальнейшие действия

- Сведения о [различиях между ресурсами](migrate-azure-ad-graph-resource-differences.md) в Azure AD Graph и Microsoft Graph.
- Снова просмотрите [Контрольный список](migrate-azure-ad-graph-planning-checklist.md) .

<!-- {
  "type": "#page.annotation",
  "suppressions": [
    "Warning: /concepts/migrate-azure-ad-graph-feature-changes.md:
      Failed to parse any rows out of table with headers: |Task|Azure AD Graph|Microsoft Graph|"
  ],
}
-->

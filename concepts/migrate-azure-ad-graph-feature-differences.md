---
title: Различия между функциями Azure AD Graph и Microsoft Graph
description: Описание различий между функциями API Azure Active Directory (Azure AD) и API Microsoft Graph, которые помогут быстро и легко перенести приложения.
author: dkershaw10
localization_priority: Normal
ms.prod: microsoft-identity-platform
ms.openlocfilehash: 531b2c9b441f328118597802b6478d5b45276965
ms.sourcegitcommit: 0545b031585e605dc3a0fde481015f51f79819c4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/22/2020
ms.locfileid: "45224880"
---
# <a name="feature-differences-between-azure-ad-graph-and-microsoft-graph"></a><span data-ttu-id="ee475-103">Различия между функциями Azure AD Graph и Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="ee475-103">Feature differences between Azure AD Graph and Microsoft Graph</span></span>

<span data-ttu-id="ee475-104">Эта статья входит в *Шаг 1: Ознакомьтесь с различиями* в API [процесса переноса приложений](migrate-azure-ad-graph-planning-checklist.md).</span><span class="sxs-lookup"><span data-stu-id="ee475-104">This article is part of *step 1: review API differences* of the [process to migrate apps](migrate-azure-ad-graph-planning-checklist.md).</span></span>

<span data-ttu-id="ee475-105">Многие функции Microsoft Graph работают аналогично своим аналогам в Azure AD Graph.</span><span class="sxs-lookup"><span data-stu-id="ee475-105">Many features in Microsoft Graph work similarly to their Azure AD Graph counterparts.</span></span> <span data-ttu-id="ee475-106">Однако некоторые изменения и/или улучшены.</span><span class="sxs-lookup"><span data-stu-id="ee475-106">However, a few have been changed and/or improved.</span></span> <span data-ttu-id="ee475-107">Здесь вы узнаете, как адаптировать ваши приложения, чтобы воспользоваться преимуществами этих различий.</span><span class="sxs-lookup"><span data-stu-id="ee475-107">Here, you'll learn how to adapt your apps to take advantage of these differences.</span></span>  <span data-ttu-id="ee475-108">Часто изменения являются незначительными, но хорошо подходят.</span><span class="sxs-lookup"><span data-stu-id="ee475-108">Frequently, the changes are minor, but well worth the effort.</span></span>

<span data-ttu-id="ee475-109">В этой статье рассказывается, как обрабатываются Microsoft Graph:</span><span class="sxs-lookup"><span data-stu-id="ee475-109">This article explores how Microsoft Graph handles:</span></span>

- <span data-ttu-id="ee475-110">Расширения схемы каталога</span><span class="sxs-lookup"><span data-stu-id="ee475-110">Directory schema extensions</span></span>
- <span data-ttu-id="ee475-111">Разностные запросы</span><span class="sxs-lookup"><span data-stu-id="ee475-111">Differential queries</span></span>
- <span data-ttu-id="ee475-112">Пакетная обработка</span><span class="sxs-lookup"><span data-stu-id="ee475-112">Batching</span></span>

## <a name="directory-schema-extensions"></a><span data-ttu-id="ee475-113">Расширения схемы каталога</span><span class="sxs-lookup"><span data-stu-id="ee475-113">Directory schema extensions</span></span>

<span data-ttu-id="ee475-114">Если ваше приложение использует расширения схемы каталога Graph Azure AD, вы можете продолжать использовать одни и те же базовые API (с URL-адресами запросов Microsoft Graph):</span><span class="sxs-lookup"><span data-stu-id="ee475-114">If your app uses Azure AD Graph directory schema extensions, you can continue to use the same basic APIs (with Microsoft Graph request URLs) to:</span></span>

- <span data-ttu-id="ee475-115">Управление определениями свойств расширения с помощью свойства **екстенсионпропертиес** в ресурсе [Application] [/граф/АПИ/ресаурцес/аппликатион? View = Graph-REST-v 1.0).</span><span class="sxs-lookup"><span data-stu-id="ee475-115">Manage extension property definitions using the **extensionProperties** property on the [application][/graph/api/resources/application?view=graph-rest-v1.0) resource.</span></span>
- <span data-ttu-id="ee475-116">Получите доступные свойства расширения с помощью действия [жетаваилабликстенсионпропертиес](/graph/api/directoryobject-getavailableextensionproperties?view=graph-rest-v1.0) .</span><span class="sxs-lookup"><span data-stu-id="ee475-116">Get available extension properties using the [getAvailableExtensionProperties](/graph/api/directoryobject-getavailableextensionproperties?view=graph-rest-v1.0) action.</span></span>
- <span data-ttu-id="ee475-117">Считывание значений расширений с помощью GET и`$select`</span><span class="sxs-lookup"><span data-stu-id="ee475-117">Read extension values using GET and `$select`</span></span>
- <span data-ttu-id="ee475-118">Поиск по значениям расширений с помощью GET и`$filter`</span><span class="sxs-lookup"><span data-stu-id="ee475-118">Search on extension values using GET and `$filter`</span></span>
- <span data-ttu-id="ee475-119">Обновление значений расширений с помощью PATCH</span><span class="sxs-lookup"><span data-stu-id="ee475-119">Update extension values using PATCH</span></span>
- <span data-ttu-id="ee475-120">Удаление значений расширений с помощью PATCH (устанавливается в **значение NULL**)</span><span class="sxs-lookup"><span data-stu-id="ee475-120">Remove extension values using PATCH (set to **null**)</span></span>

<span data-ttu-id="ee475-121">Microsoft Graph предоставляет расширенные возможности для разработчиков расширений схемы, которые в настоящее время не совместимы с экстентами схемы каталога Azure AD Graph.</span><span class="sxs-lookup"><span data-stu-id="ee475-121">Microsoft Graph provides an enhanced schema extensions developer experience, which today is not backwards compatible with Azure AD Graph directory schema extentions.</span></span> <span data-ttu-id="ee475-122">Чтобы узнать больше, ознакомьтесь с разрешениями [в разделе Добавление пользовательских данных в расширениях схемы](/graph/extensibility-overview#schema-extensions).</span><span class="sxs-lookup"><span data-stu-id="ee475-122">To learn more, see [schema extensions in add custom data](/graph/extensibility-overview#schema-extensions).</span></span>

### <a name="recommended-migration-approach"></a><span data-ttu-id="ee475-123">Рекомендуемый подход к миграции</span><span class="sxs-lookup"><span data-stu-id="ee475-123">Recommended migration approach</span></span>

<span data-ttu-id="ee475-124">Если приложение Azure AD Graph использует расширения схемы каталога, выполните добавочный подход к переносу приложения в Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="ee475-124">If your Azure AD Graph app uses directory schema extensions, take an incremental approach to migrate the app to Microsoft Graph.</span></span>

<span data-ttu-id="ee475-125">Сначала переключите приложение на использование вызовов API Microsoft Graph, но позвольте приложению продолжить использовать расширения схемы каталога Azure AD Graph.</span><span class="sxs-lookup"><span data-stu-id="ee475-125">First, switch your app to using Microsoft Graph API calls, but let the app continue to leverage Azure AD Graph directory schema extensions.</span></span>

<span data-ttu-id="ee475-126">Затем можно переключиться на использование расширений схемы Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="ee475-126">Then, you can switch to using Microsoft Graph schema extensions.</span></span> <span data-ttu-id="ee475-127">В некоторых случаях переключение не будет подходящимся.</span><span class="sxs-lookup"><span data-stu-id="ee475-127">In some cases, switching will not be appropriate.</span></span> <span data-ttu-id="ee475-128">Не переключать, если:</span><span class="sxs-lookup"><span data-stu-id="ee475-128">Do not switch if:</span></span>

- <span data-ttu-id="ee475-129">Ваше приложение использует расширения схемы каталогов, созданные с помощью AD Connect, или</span><span class="sxs-lookup"><span data-stu-id="ee475-129">Your app uses directory schema extensions created through AD Connect, or</span></span>
- <span data-ttu-id="ee475-130">Приложение полагается на значения расширения схемы каталога в утверждениях маркеров.</span><span class="sxs-lookup"><span data-stu-id="ee475-130">Your app relies on directory schema extension values in token claims.</span></span>

><span data-ttu-id="ee475-131">**Note**: использование свойств расширения схемы Microsoft Graph в качестве утверждений в маркере с использованием необязательных утверждений или в динамическом правиле членства также пока не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="ee475-131">**NOTE**: Using Microsoft Graph schema extension properties as claims in a token using optional claims or in a dynamic membership rule is also not yet supported.</span></span>

<span data-ttu-id="ee475-132">Чтобы перейти к новой модели расширения схемы Microsoft Graph, необходимо выполнить следующие действия:</span><span class="sxs-lookup"><span data-stu-id="ee475-132">To switch to the newer Microsoft Graph schema extension model, you'll need to:</span></span>

- <span data-ttu-id="ee475-133">Определение новых определений расширений схемы с помощью Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="ee475-133">Define new schema extension definitions using Microsoft Graph.</span></span>
- <span data-ttu-id="ee475-134">Обновите приложение, чтобы обеспечить поддержку новых определений расширений схемы.</span><span class="sxs-lookup"><span data-stu-id="ee475-134">Update the app to support the new schema extension definitions.</span></span>
- <span data-ttu-id="ee475-135">Перенесите данные из свойств расширения схемы Azure AD в новые свойства расширения схемы Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="ee475-135">Migrate the data from the Azure AD schema extension properties to the new Microsoft Graph schema extension properties.</span></span>  <span data-ttu-id="ee475-136">Автоматическая миграция данных не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="ee475-136">Automatic migration of data is not supported.</span></span>

## <a name="differential-queries"></a><span data-ttu-id="ee475-137">Разностные запросы</span><span class="sxs-lookup"><span data-stu-id="ee475-137">Differential queries</span></span>

<span data-ttu-id="ee475-138">Azure AD Graph и Microsoft Graph позволяют отслеживать изменения с помощью запросов.</span><span class="sxs-lookup"><span data-stu-id="ee475-138">Azure AD Graph and Microsoft Graph let you track changes using queries.</span></span>  <span data-ttu-id="ee475-139">Высокоуровневый подход похож на два API, но синтаксис отличается.</span><span class="sxs-lookup"><span data-stu-id="ee475-139">The high-level approach is similar between the two APIs, but the syntax is different.</span></span>

<span data-ttu-id="ee475-140">Graph Azure AD вызывает эти разностные запросы.</span><span class="sxs-lookup"><span data-stu-id="ee475-140">Azure AD Graph calls these differential queries.</span></span>  <span data-ttu-id="ee475-141">В Microsoft Graph они являются [разностными запросами](/graph/delta-query-overview).</span><span class="sxs-lookup"><span data-stu-id="ee475-141">In Microsoft Graph, they're [delta queries](/graph/delta-query-overview).</span></span>

<span data-ttu-id="ee475-142">В следующей таблице представлены основные сходства и различия:</span><span class="sxs-lookup"><span data-stu-id="ee475-142">The following table highlights key similarities and differences:</span></span>

|<span data-ttu-id="ee475-143">Запрос Delta</span><span class="sxs-lookup"><span data-stu-id="ee475-143">Delta request</span></span> |<span data-ttu-id="ee475-144">Azure AD Graph</span><span class="sxs-lookup"><span data-stu-id="ee475-144">Azure AD Graph</span></span> | <span data-ttu-id="ee475-145">Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="ee475-145">Microsoft Graph</span></span> |
|----|----|----|
| <span data-ttu-id="ee475-146">_Первоначальный запрос данных_</span><span class="sxs-lookup"><span data-stu-id="ee475-146">_Initial data request_</span></span> | <span data-ttu-id="ee475-147">Использует параметр запроса:</span><span class="sxs-lookup"><span data-stu-id="ee475-147">Uses a query parameter:</span></span><br>`GET /groups?deltaLink=` | <span data-ttu-id="ee475-148">Использует функцию:</span><span class="sxs-lookup"><span data-stu-id="ee475-148">Uses a function:</span></span> <br> `GET /groups/delta` |
| <span data-ttu-id="ee475-149">_Получение новых изменений_</span><span class="sxs-lookup"><span data-stu-id="ee475-149">_Get new changes_</span></span> | `GET /groups?deltaLink={deltaToken}` | `GET /groups/delta?$deltaToken={deltaToken}` |
| <span data-ttu-id="ee475-150">_Синхронизация в данный момент_</span><span class="sxs-lookup"><span data-stu-id="ee475-150">_Sync from now_</span></span> |<span data-ttu-id="ee475-151">Использует настраиваемый заголовок HTTP:</span><span class="sxs-lookup"><span data-stu-id="ee475-151">Uses a custom HTTP header:</span></span><br> `ocp-aad-dq-include-only-delta-token: true` | <span data-ttu-id="ee475-152">Использует параметр запроса:</span><span class="sxs-lookup"><span data-stu-id="ee475-152">Uses a query parameter:</span></span> <br> `GET /groups/delta?$deltaToken=latest` |
| <span data-ttu-id="ee475-153">_Отслеживание изменений для Директорйобжектс_</span><span class="sxs-lookup"><span data-stu-id="ee475-153">_Track changes for directoryObjects_</span></span> | <span data-ttu-id="ee475-154">Возвращает изменения для нескольких ресурсов (пользователей и групп) в одной и той же операции:&nbsp;&nbsp;</span><span class="sxs-lookup"><span data-stu-id="ee475-154">Gets changes for multiple resource (user and group) in the same operation:&nbsp;&nbsp;</span></span><br> `GET /directoryObject?$filter=isof('User') or isof('Group')&deltaLink=` | <span data-ttu-id="ee475-155">Использует отдельные запросы в Microsoft Graph, по одному для каждого ресурса.</span><span class="sxs-lookup"><span data-stu-id="ee475-155">Uses separate queries with Microsoft Graph, one for each resource.</span></span> |
| <span data-ttu-id="ee475-156">_Получение изменений ресурсов и связей_</span><span class="sxs-lookup"><span data-stu-id="ee475-156">_Get resource and relationship changes_</span></span> | <span data-ttu-id="ee475-157">Все запросы возвращают изменения ресурсов и связей, если у ресурса есть связи.</span><span class="sxs-lookup"><span data-stu-id="ee475-157">All requests return resource and relationship changes, if the resource has relationships.</span></span> | `GET /groups/delta?$expand=members` |
| <span data-ttu-id="ee475-158">_Ответ, указывающий на новые и измененные элементы_</span><span class="sxs-lookup"><span data-stu-id="ee475-158">_Response indicating new and changed items_</span></span> | <ul><li><p><span data-ttu-id="ee475-159">Представляет новые экземпляры, созданные в стандартном представлении.</span><span class="sxs-lookup"><span data-stu-id="ee475-159">Represents newly created instances using their standard representation.</span></span></p></li><li><p><span data-ttu-id="ee475-160">Обновленные экземпляры представлены по их идентификатору, *по крайней мере* , к свойствам, которые были обновлены.</span><span class="sxs-lookup"><span data-stu-id="ee475-160">Updated instances are represented by their id with *at least* the properties that have been updated.</span></span> <span data-ttu-id="ee475-161">Могут быть включены и другие свойства.</span><span class="sxs-lookup"><span data-stu-id="ee475-161">Other properties may be included.</span></span></p></li><li><p><span data-ttu-id="ee475-162">Отношения представлены в виде `directoryLinkChange` типа.</span><span class="sxs-lookup"><span data-stu-id="ee475-162">Relationships are represented as the `directoryLinkChange` type.</span></span></p></li></ul>|<ul><li><p><span data-ttu-id="ee475-163">Представляет новые экземпляры, созданные в стандартном представлении.</span><span class="sxs-lookup"><span data-stu-id="ee475-163">Represents newly created instances using their standard representation.</span></span></p></li><li><p><span data-ttu-id="ee475-164">Обновленные экземпляры представлены по их идентификатору, *по крайней мере* , к свойствам, которые были обновлены.</span><span class="sxs-lookup"><span data-stu-id="ee475-164">Updated instances are represented by their id with *at least* the properties that have been updated.</span></span> <span data-ttu-id="ee475-165">Могут быть включены и другие свойства.</span><span class="sxs-lookup"><span data-stu-id="ee475-165">Other properties may be included.</span></span></p></li><li><p><span data-ttu-id="ee475-166">Связи представлены в виде аннотаций в стандартном представлении ресурсов.</span><span class="sxs-lookup"><span data-stu-id="ee475-166">Relationships are represented as annotations on the standard resource representation.</span></span> <span data-ttu-id="ee475-167">В этих заметках используется формат `propertyName@delta` , например `members@delta` для изменения членства в группе.</span><span class="sxs-lookup"><span data-stu-id="ee475-167">These annotations use the format `propertyName@delta`, for example `members@delta` for a group's membership changes.</span></span></p></li></ul> |
| <span data-ttu-id="ee475-168">_Ответ, указывающий на удаленные элементы_</span><span class="sxs-lookup"><span data-stu-id="ee475-168">_Response indicating  deleted items_</span></span>| <span data-ttu-id="ee475-169">Указывает удаленному элементу с дополнительным свойством AAD. для свойства "с *удалением* " значение true.</span><span class="sxs-lookup"><span data-stu-id="ee475-169">Indicates a deleted item with an additional property of *aad.isDeleted* set to true.</span></span> | <span data-ttu-id="ee475-170">Указывает удаленный элемент с \@ удаленной заметкой.</span><span class="sxs-lookup"><span data-stu-id="ee475-170">Indicates a deleted item with the \@removed annotation.</span></span> <span data-ttu-id="ee475-171">Он также может содержать код причины, указывающий на то, что элемент удален, но его можно восстановить или удалить без возможности восстановления.</span><span class="sxs-lookup"><span data-stu-id="ee475-171">It may also contain a reason code, which indicates if the item is deleted, but can be restored, or is permanently deleted.</span></span> |

<span data-ttu-id="ee475-172">Если ваше приложение уже сохраняет данные о состоянии, рассмотрите возможность использования параметра "Синхронизация из", показанного ранее, для управления переходом на запросы разности.</span><span class="sxs-lookup"><span data-stu-id="ee475-172">If your app is already storing state data, consider using the "sync from now" shown earlier to help manage the transition to delta queries.</span></span>

## <a name="batching"></a><span data-ttu-id="ee475-173">Пакетная обработка</span><span class="sxs-lookup"><span data-stu-id="ee475-173">Batching</span></span>

<span data-ttu-id="ee475-174">Azure AD Graph использовал систему, называемую многокомпонентными сообщениями MIME, для управления пакетной.</span><span class="sxs-lookup"><span data-stu-id="ee475-174">Azure AD Graph used a system called multi-part MIME messages to manage batching.</span></span>  <span data-ttu-id="ee475-175">Microsoft Graph использует [пакетную обработку JSON](json-batching.md) , чтобы разрешить до 20 запросов в одной пакетной операции.</span><span class="sxs-lookup"><span data-stu-id="ee475-175">Microsoft Graph uses [JSON batching](json-batching.md) to permit up to 20 requests in a single batch operation.</span></span> <span data-ttu-id="ee475-176">Механизм пакетной обработки JSON значительно проще использовать, особенно вместе с библиотеками синтаксического анализа JSON.</span><span class="sxs-lookup"><span data-stu-id="ee475-176">The JSON batching mechanism is significantly simpler to use, especially together with JSON parsing libraries.</span></span>  <span data-ttu-id="ee475-177">Он также позволяет выполнять виртуализацию пакетных операций.</span><span class="sxs-lookup"><span data-stu-id="ee475-177">It also allows for sequencing batch operations.</span></span>  <span data-ttu-id="ee475-178">Однако это не совместимо с пакетным способом пакетной обработки графа Azure AD.</span><span class="sxs-lookup"><span data-stu-id="ee475-178">However, it is not backwards compatible with the Azure AD Graph batching approach.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ee475-179">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="ee475-179">Next Steps</span></span>

- <span data-ttu-id="ee475-180">Сведения о [различиях между ресурсами](migrate-azure-ad-graph-resource-differences.md) в Azure AD Graph и Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="ee475-180">Learn about [resource differences](migrate-azure-ad-graph-resource-differences.md) between Azure AD Graph and Microsoft Graph.</span></span>
- <span data-ttu-id="ee475-181">Ознакомьтесь с разрешениями на [Добавление пользовательских данных](/graph/extensibility-overview) для получения сведений об открытых расширениях и расширениях схемы.</span><span class="sxs-lookup"><span data-stu-id="ee475-181">Explore [add custom data](/graph/extensibility-overview) for information about open and schema extensions.</span></span>
- <span data-ttu-id="ee475-182">Изучите [запросы Delta](/graph/delta-query-overview) , чтобы узнать о версии разностного запроса Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="ee475-182">Explore [delta queries](/graph/delta-query-overview) to learn about Microsoft Graph's version of differential query.</span></span>
- <span data-ttu-id="ee475-183">Изучите [пакетную обработку JSON](json-batching.md) , чтобы понять, как работает Пакетная обработка в Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="ee475-183">Explore [JSON batching](json-batching.md) to understand how batching works in Microsoft Graph.</span></span>
- <span data-ttu-id="ee475-184">Поэкспериментируйте с Microsoft Graph с помощью [проводника диаграмм](https://aka.ms/ge) .</span><span class="sxs-lookup"><span data-stu-id="ee475-184">Use [Graph Explorer](https://aka.ms/ge) to experiment with Microsoft Graph.</span></span>

<!-- {
  "type": "#page.annotation",
  "suppressions": [
    "Warning: /concepts/migrate-azure-ad-graph-feature-changes.md:
      Failed to parse any rows out of table with headers: |Task|Azure AD Graph|Microsoft Graph|"
  ],
}
-->

---
title: Создание и отправка уведомления из службы приложений
description: 'Настройте свою службу приложений для отправки уведомлений, ориентированных на пользователя, в разные клиенты через Microsoft Graph. '
localization_priority: Priority
ms.prod: notifications
author: merzink
ms.openlocfilehash: cf14534fe2f789165a3580da833b3d49d803a2ca
ms.sourcegitcommit: 3fbc2249b307e8d3a9de18f22ef6911094ca272c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/26/2020
ms.locfileid: "48288660"
---
# <a name="create-and-send-a-notification-from-your-app-service"></a><span data-ttu-id="5d57c-103">Создание и отправка уведомления из службы приложений</span><span class="sxs-lookup"><span data-stu-id="5d57c-103">Create and send a notification from your app service</span></span>

<span data-ttu-id="5d57c-104">Вы можете создавать и отправлять уведомления пользователю с помощью API Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="5d57c-104">You can create and send a notification to a user by using Microsoft Graph APIs.</span></span> <span data-ttu-id="5d57c-105">Уведомление хранится в хранилище службы уведомлений Microsoft Graph и отправляется всем клиентам приложений на всех устройствах, с которых целевой пользователь выполнил вход в систему.</span><span class="sxs-lookup"><span data-stu-id="5d57c-105">The notification is stored in the Microsoft Graph Notifications service store and is sent to all app clients on all devices that the target user is signed in on.</span></span> 

<span data-ttu-id="5d57c-106">Чтобы отправить уведомление пользователю, служба приложений выполнит указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="5d57c-106">In order to send a notification to your user, your application service will:</span></span>
1. <span data-ttu-id="5d57c-107">[Проверка подлинности](/azure/active-directory/develop/v1-oauth2-client-creds-grant-flow) на платформе удостоверений Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="5d57c-107">[Authenticate](/azure/active-directory/develop/v1-oauth2-client-creds-grant-flow) with the Microsoft identity platform.</span></span>
2. <span data-ttu-id="5d57c-108">Отправка уведомления в API Microsoft Graph при помощи маркера проверки подлинности с указанием [идентификатора подписки на уведомления пользователя](/graph/api/notifications-post), полученного из клиента приложения при создании подписки.</span><span class="sxs-lookup"><span data-stu-id="5d57c-108">Post a notification to the Microsoft Graph API using the auth token, and target the user with a [user notification subscription ID](/graph/api/notifications-post) that is obtained from your app client when creating a subscription.</span></span>

> [!NOTE]
> <span data-ttu-id="5d57c-109">Чтобы упростить проверку подлинности, рекомендуем использовать новый, улучшенный и компактный [пакет SDK уведомлений](https://aka.ms/GNSDK) на стороне клиента с идентификатором подписки на уведомления пользователя, чтобы получать уведомления и управлять их состоянием.</span><span class="sxs-lookup"><span data-stu-id="5d57c-109">For a simplified authentication story, we recommend using the new and improved, lightweight [notification SDK](https://aka.ms/GNSDK) on the client-side with a user notification subscription ID to receive notifications and manage notification state.</span></span> <span data-ttu-id="5d57c-110">Вы также можете отправлять уведомления от имени пользователя с помощью делегированных разрешений, а службе приложений потребуется хранить маркеры доступа и обновления. Однако это не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="5d57c-110">Alternatively, you can  post notifications on behalf of the user via delegated permissions and your app service will need to maintain access tokens and refresh tokens, but this is not recommended.</span></span> <span data-ttu-id="5d57c-111">Дополнительные сведения о потоке OBO OAuth 2.0 см. в статье [Вызовы между службами с использованием делегированного удостоверения пользователя в потоке On-Behalf-Of](/azure/active-directory/develop/v1-oauth2-on-behalf-of-flow).</span><span class="sxs-lookup"><span data-stu-id="5d57c-111">To learn more about OAuth 2.0 OBO flow, see [Service-to-service calls that use delegated user identity in the On-Behalf-Of flow](/azure/active-directory/develop/v1-oauth2-on-behalf-of-flow).</span></span> 


## <a name="guaranteed-delivery-on-ios"></a><span data-ttu-id="5d57c-112">Гарантированная доставка в iOS</span><span class="sxs-lookup"><span data-stu-id="5d57c-112">Guaranteed delivery on iOS</span></span>

<span data-ttu-id="5d57c-113">На таких платформах, как iOS, при определенных уровнях производительности уведомления о необработанных данных могут доставляться с задержкой в связи с пакетной обработкой или вообще не достигать конечной точки.</span><span class="sxs-lookup"><span data-stu-id="5d57c-113">On platforms like iOS, under certain power conditions, raw data notifications might be delayed in delivery due to batching, or not reach the target endpoint at all.</span></span> <span data-ttu-id="5d57c-114">В случае высокоприоритетных уведомлений, доставляемых пользователям в iOS, платформа уведомлений Microsoft Graph позволяет выбрать функцию "резервирования" всплывающих уведомлений из необработанных данных в визуальные на целевом устройстве iOS, обеспечивая уведомление пользователей практически в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="5d57c-114">For high-priority notifications being delivered to users on iOS, the Microsoft Graph notifications platform allows you to specify a raw-to-visual toast notification "fallback" option that automatically sends a visual toast notification to the target iOS device, thereby ensuring your user gets notified near real-time.</span></span> <span data-ttu-id="5d57c-115">Сведения о том, как использовать параметры резервирования, см. в описании [ресурса notification](/graph/api/resources/projectrome-notification.md).</span><span class="sxs-lookup"><span data-stu-id="5d57c-115">To learn how to leverage fallback options, please see the [notification resource](/graph/api/resources/projectrome-notification.md).</span></span>  

## <a name="getting-started"></a><span data-ttu-id="5d57c-116">Начало работы</span><span class="sxs-lookup"><span data-stu-id="5d57c-116">Getting started</span></span>
<span data-ttu-id="5d57c-117">Сведения о том, как служба приложений может начать отправлять уведомления пользователям, см. в описании объекта [notification](/graph/api/resources/projectrome-notification) и нашем [образце службы приложений](https://aka.ms/gnsample-appservice).</span><span class="sxs-lookup"><span data-stu-id="5d57c-117">To learn how your app service can start sending notifications to your users, see [notification](/graph/api/resources/projectrome-notification) and our [App Service sample](https://aka.ms/gnsample-appservice).</span></span>
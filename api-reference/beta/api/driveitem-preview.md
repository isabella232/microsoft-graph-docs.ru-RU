---
title: 'driveItem: Preview'
description: Это действие позволяет получать кратковременно недопустимые URL-адреса для встраиваемых элементов, чтобы отобразить временный предварительный просмотр.
localization_priority: Normal
ms.prod: sharepoint
doc_type: apiPageType
author: JeremyKelley
ms.openlocfilehash: 074bc4c0da2362c6be9958be3ffec8dd4027b690
ms.sourcegitcommit: a6d284b3726139f11194aa3d23b8bb79165cc09e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "46808825"
---
# <a name="driveitem-preview"></a>driveItem: Preview

Пространство имен: microsoft.graph

[!INCLUDE [beta-disclaimer](../../includes/beta-disclaimer.md)]

Это действие позволяет получать кратковременно недопустимые URL-адреса для встраиваемых элементов, чтобы отобразить временный предварительный просмотр.

Если вы хотите получить ссылки с большим сроком действия, используйте вместо этого API [CreateLink][] .

> **Примечание:** В настоящее время действие **Предварительный просмотр** доступно только в SharePoint и OneDrive для бизнеса.

[createLink]: driveitem-createlink.md

## <a name="permissions"></a>Разрешения

Для вызова этого API требуется одно из указанных ниже разрешений. Дополнительные сведения, включая сведения о том, как выбрать разрешения, см. в статье [Разрешения](/graph/permissions-reference).

| Тип разрешения                        | Разрешения (в порядке повышения привилегий)
|:---------------------------------------|:-------------------------------------------
| Делегированные (рабочая или учебная учетная запись)     | Files. Read, Files. ReadWrite, Files. ReadWrite. ALL, sites. ReadWrite. ALL.
| Делегированные (личная учетная запись Майкрософт) | Files. Read, Files. ReadWrite, Files. ReadWrite. ALL
| Для приложений                            | Не поддерживается.

## <a name="http-request"></a>HTTP-запрос

<!-- { "blockType": "ignored" } -->

```http
POST /drives/{driveId}/items/{itemId}/preview
POST /groups/{groupId}/drive/items/{itemId}/preview
POST /me/drive/items/{itemId}/preview
POST /sites/{siteId}/drive/items/{itemId}/preview
POST /users/{userId}/drive/items/{itemId}/preview
POST /shares/{shareId}/driveItem/preview
```

## <a name="request-body"></a>Текст запроса

В теле запроса определяются свойства внедряемого URL-адреса, запрашиваемого приложением.
Запрос должен быть объектом JSON с указанными ниже свойствами.

|   Имя      |  Тип         | Описание
|:------------|:--------------|:-----------------------------------------------
| Просмотр      | string        | Необязательный параметр. Предварительная версия приложения для использования. `onedrive` или `office`. Если значение равно null, подходящее средство просмотра будет выбрано автоматически.
| не для Chrome  | boolean       | Необязательный параметр. Если `true` выбрано значение (по умолчанию), то Внедренное представление не будет содержать элементы управления.
| алловедит   | boolean       | Необязательный параметр. Если `true` файл можно редактировать из встроенного пользовательского интерфейса.
| page        | строка или число | Необязательное свойство. Номер страницы для начала документа, если это необходимо. Указывается как строка для будущих случаев использования для типов файлов, таких как ZIP.
| zoom        | number        | Необязательный параметр. Масштаб (при необходимости) для запуска.

## <a name="response"></a>Ответ

```json
{
    "getUrl": "https://www.onedrive.com/embed?foo=bar&bar=baz",
    "postParameters": "param1=value&param2=another%20value",
    "postUrl": "https://www.onedrive.com/embed_by_post"
}
```

Ответом будет объект JSON, содержащий следующие свойства:

| Имя           | Тип   | Описание
|:---------------|:-------|:---------------------------------------------------
| Команда         | string | URL-адрес, подходящие для внедрения с помощью HTTP GET (Iframes и т. д.)
| постурл        | string | URL-адрес, подходящий для внедрения с помощью HTTP POST (форма POST, JS и т. д.)
| Параметры | string | Параметры POST для включения при использовании Постурл

В зависимости от текущего состояния поддержки внедрения для заданных параметров может возвращаться либо getUrl, Постурл, либо и то, и другое.

i-параметры — это строка, отформатированная как `application/x-www-form-urlencoded` , и при выполнении POST для постурл Content-Type необходимо задать соответствующие параметры. Пример:
```
POST https://www.onedrive.com/embed_by_post
Content-Type: application/x-www-form-urlencoded

param1=value&param2=another%20value
```

### <a name="viewers"></a>Наблюдатели

Для параметра **средства просмотра** разрешены следующие значения.

| Значение типа | Описание
|:-----------|:----------------------------------------------------------------
| определен     | Выбирает соответствующее приложение для отображения файла. В большинстве случаев будет использоваться `onedrive` Предварительный просмотр, но он может варьироваться в зависимости от типа файла.
| `onedrive` | Использование приложения предварительного просмотра OneDrive для отображения файла.
| `office`   | Используйте веб-версию Office для отображения файла. Допускается только для документов Office.

### <a name="chrome-vs-chromeless"></a>Хром VS Chrome

Если `chromeless` этот параметр имеет значение true, предварительный просмотр будет иметь исходное представление файла.
В противном случае для взаимодействия с документом или представлением могут отображаться дополнительные панели инструментов и кнопки.

### <a name="viewedit"></a>Просмотр и редактирование

Если `allowEdit` имеет значение true, документ можно изменить с помощью встроенной предварительной версии.
Эта возможность может быть недоступна для предварительных версий приложений и типов файлов.

### <a name="pagezoom"></a>Страница/масштаб

`page`Параметры и `zoom` могут быть недоступны для всех предварительных версий приложений, но будут применены, если это приложение поддерживает приложение предварительного просмотра.

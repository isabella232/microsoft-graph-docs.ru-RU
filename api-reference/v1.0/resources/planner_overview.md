# <a name="use-the-planner-rest-api"></a>Использование планировщика API REST

В Microsoft Graph можно использовать планировщик API для создания задач и назначения их для пользователей в группе в Office 365.

Прежде чем начинать работу с планировщиком API, изучите, как основные объекты связаны друг с другом и группами Office 365.

## <a name="groups"></a>Группы

Группы Office 365 — это владельцы планов в планировщике API.
Чтобы [получить планы, которыми владеет группа](../api/plannergroup_list_plans.md), сделайте следующий HTTP-запрос.

``` http
GET /groups/{id}/planner/plans
```

При [создании нового плана](../api/planner_post_plans.md) сделайте группу его владельцем, задав свойство `owner` для объекта плана. Планы должны принадлежать группам.

>**Примечание:** пользователь, создающий план, должен быть членом группы, которая будет владельцем плана. При создании новой группы с помощью кнопки [Создать группу](../api/group_post_groups.md) вы не будете добавлены в группу в качестве члена. После создания группы добавьте себя в качестве члена с помощью [членов группы с правом записи](../api/group_post_members.md).

## <a name="plans"></a>Планы

[Планы](plannerplan.md) — это контейнеры [задач](plannertask.md). Чтобы [создать задачу в плане](../api/planner_post_tasks.md), при ее создании укажите в качестве свойства `planId` объекта задачи идентификатор плана.
В настоящее время не создаются задачи без планов.
Для [получения задач в плане](../api/plannerplan_list_tasks.md)сделайте следующий HTTP-запрос.

``` http
GET /planner/plans/{id}/tasks
```

## <a name="tasks"></a>Задачи

Задачу можно назначить пользователю, добавив [назначение](plannerassignment.md) в свойстве [assignments](plannerassignments.md) объекта задачи. Идентификатор исполнителя задачи — это имя открытого свойства `assignments`, необходимо также указать свойство `orderHint` назначения.

## <a name="task-and-plan-details"></a>Данные задач и плана 

Ресурсы Планировщика делятся на базовые объекты и объекты сведений. Базовые объекты предоставляют доступ к основным свойствам ресурсов, подходящим для списков, а объекты сведений обеспечивают доступ к большим свойствам ресурсов, которые подходят для развернутых представлений.

## <a name="visualization"></a>Визуализация

Помимо данных задач и плана, API Планировщика предоставляет ресурсы для общей визуализации данных по клиентам. Для перечисленных ниже задач доступны несколько типов визуализации данных.

| Способ представления задач                                                                        | Источник информации для упорядочивания задач                                         |
| :---------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------ |
| Простой список (задачи в плане)                                                               | `orderHint` |||UNTRANSLATED_CONTENT_START|||property on tasks|||UNTRANSLATED_CONTENT_END|||                                                   |
| Простой список (задачи, назначенные пользователю)                                                      | `assigneePriority` |||UNTRANSLATED_CONTENT_START|||property on tasks|||UNTRANSLATED_CONTENT_END|||                                            |
| Доска со столбцами для исполнителей (доска задач "Кому назначено")                            | Объект [assignedToTaskBoardTaskFormat](plannerassignedToTaskBoardTaskFormat.md) |
| Доска со столбцами для хода выполнения задачи (доска задач "Ход выполнения") | Объект [progressTaskBoardTaskFormat](plannerprogressTaskBoardTaskFormat.md)     |
| Доска с настраиваемыми столбцами задач (доска задач "Сегменты"):                              | объект [bucketTaskBoardTaskFormat](plannerbucketTaskBoardTaskFormat.md)         |

Настраиваемые столбцы на доске задач "Сегменты" представлены объектами [сегментов](plannerbucket.md), а их порядок — свойством `orderHint` объекта.

Принципы упорядочивания определены в статье [Использование указаний по упорядочиванию в планировщике](planner_order_hint_format.md).

## <a name="planner-resource-versioning"></a>Версии ресурсов в планировщике

Планировщик управляет версиями ресурсов с помощью тегов etag. Эти теги возвращаются со свойством `@odata.etag` для каждого ресурса, а в запросах `PATCH` и `DELETE` последний тег etag, известный клиенту, необходимо указывать с заголовком `If-Match`. Планировщик позволяет изменять старые версии ресурсов, если планируемое изменение не конфликтует с более новыми изменениями, принятыми службой Планировщика в том же ресурсе. Клиенты могут определить, какой тег etag ресурса новее, вычислив большее значение тега etag при сравнении порядкового номера строки. У каждого ресурса есть отдельный тег etag. Невозможно сравнить значения тегов etag для разных ресурсов, в том числе с отношениями вложения. Клиентские приложения должны обрабатывать две ошибки, связанные с версиями, 409 и 412, считывая последнюю версию элемента и устраняя конфликтующие изменения.

## <a name="common-planner-error-conditions"></a>Основные ошибки планировщика

В дополнение к [общим ошибкам](../../../concepts/errors.md) Microsoft Graph, некоторые ошибки относятся только к API планировщика.

### <a name="400-bad-request"></a>400 (неправильный запрос)

В некоторых случаях на запросы `POST` и `PATCH` может быть получен код состояния 400. Ниже перечислены основные проблемы:

* Открытые свойства имеют неправильный тип, тип не указан, или они не содержат свойств. Например, свойства [plannerAssignments](plannerAssignments.md) со сложными значениями должны объявлять свойство `@odata.type` со значением `microsoft.graph.plannerAssignment`.
* Указания по упорядочиванию имеют [неправильный формат](planner_order_hint_format.md). Например, в качестве указания по упорядочиванию задается значение, возвращаемое клиенту.
* Данные логически не согласованы. Например, дата начала задачи позже даты выполнения задачи.

### <a name="403-forbidden"></a>403 (доступ запрещен)

API Планировщика возвращает этот код состояния, если превышено ограничение, определенное в службе. Тип ограничения, превышенного в запросе, будет указан в свойстве `code` типа ресурса. Ниже перечислены возможные значения для типов ограничений.

| Значение                         | Описание                                                                                                                                                                                              |
| :---------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| MaximumProjectsOwnedByUser    | Превышено максимальное количество планов, принадлежащих группе. Это ограничение основано на свойстве `owner` ресурса [plannerPlan](plannerPlan.md).                                         |
| MaximumProjectsSharedWithUser | Пользователю предоставлен доступ к максимальному количеству планов.  Это ограничение основано на свойстве `sharedWith` ресурса [plannerPlanDetails](plannerPlanDetails.md).                   |
| MaximumTasksCreatedByUser     | Пользователь создал максимальное количество задач. Это ограничение основано на свойстве `createdBy` ресурса [plannerTask](plannerTask.md).                                    |
| MaximumTasksAssignedToUser    | Пользователю назначено максимальное количество задач. Это ограничение основано на свойстве `assignments` ресурса [plannerTask](plannerTask.md).                                 |
| MaximumTasksInProject         | Превышено максимальное количество задач в плане. Это ограничение основано на свойстве `planId` ресурса [plannerTask](plannerTask.md).                                               |
| MaximumActiveTasksInProject   | Превышено максимальное количество невыполненных задач в плане. Это ограничение основано на свойствах `planId` и `percentComplete` ресурса [plannerTask](plannerTask.md). |
| MaximumBucketsInProject       | Превышено максимальное количество сегментов в плане. Это ограничение основано на свойстве `planId` ресурса [plannerBucket](plannerBucket.md).                                         |
| MaximumUsersSharedWithProject | Свойство `sharedWith` ресурса [plannerPlanDetails](plannerPlanDetails.md) содержит слишком много значений.                                                                                          |
| MaximumReferencesOnTask       | Свойство `references` ресурса [plannerTaskDetails](plannerTaskDetails.md) содержит слишком много значений.                                                                                          |
| MaximumChecklistItemsOnTask   | Свойство `checklist` ресурса [plannerTaskDetails](plannerTaskDetails.md) содержит слишком много значений.                                                                                           |
| MaximumAssigneesInTasks       | Свойство `assignments` ресурса [plannerTask](plannerTask.md) содержит слишком много значений.                                                                                                       |

### <a name="412-precondition-failed"></a>412 (необходимое условие не выполнено) 

Во всех запросах `POST`, `PATCH` и `DELETE` в API Планировщика заголовок `If-Match` необходимо указывать с последним известным значением тега etag ресурса. Кроме того, код состояния 412 может быть возвращен, если значение тега etag, указанное в запросе, больше не соответствует версии ресурса в службе. В этом случае клиентам следует прочитать ресурс еще раз и получить новый тег etag.


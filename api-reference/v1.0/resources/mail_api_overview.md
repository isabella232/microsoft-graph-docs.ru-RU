# <a name="use-the-outlook-mail-rest-api"></a><span data-ttu-id="8d0c6-101">Использование интерфейса API REST почты Outlook</span><span class="sxs-lookup"><span data-stu-id="8d0c6-101">Use the Outlook mail REST API</span></span>

<span data-ttu-id="8d0c6-p101">Microsoft Graph позволяет вашему приложению получать авторизованный доступ к данным почты Outlook в личной или корпоративной учетной записи. Имея [соответствующие делегированные разрешения или разрешения приложения](../../../concepts/permissions_reference.md), приложение может получать доступ к данным почты вошедшего пользователя или любого пользователя в клиенте. Данные почты могут находиться в облаке на сервере Exchange Online (составной части Office 365) или на локальном сервере Exchange в [гибридном развертывании](../../../concepts/hybrid_rest_support.md).</span><span class="sxs-lookup"><span data-stu-id="8d0c6-p101">Microsoft Graph lets your app get authorized access to a user's Outlook mail data in a personal or organization account. With the [appropriate delegated or application permissions](../../../concepts/permissions_reference.md), your app can access the mail data of the signed-in user or any user in a tenant. The mail data can be in the cloud on Exchange Online as part of Office 365, or on Exchange on-premises in a [hybrid deployment](../../../concepts/hybrid_rest_support.md).</span></span>

## <a name="using-the-mail-rest-api"></a><span data-ttu-id="8d0c6-105">Использование REST API почты</span><span class="sxs-lookup"><span data-stu-id="8d0c6-105">Using the mail REST API</span></span>

<span data-ttu-id="8d0c6-106">Запросы API почты выполняются от имени [пользователя](../resources/user.md), который может определяться свойством пользователя **id** (уникальным GUID), адресом электронной почты или псевдонимом `me`, обозначающим вошедшего пользователя.</span><span class="sxs-lookup"><span data-stu-id="8d0c6-106">Mail API requests are performed on behalf of a [user](../resources/user.md) which can be identified by the user's **id** property (a unique GUID), email address, or the `me` shortcut alias for the signed-in user.</span></span>

<span data-ttu-id="8d0c6-p102">Сообщения электронной почты представлены ресурсом [message](../resources/message.md) и упорядочены в почтовой папке [mailFolder](../resources/mailfolder.md). Сообщения и почтовые папки определяются свойством **id**, которое можно получить из операций `GET`.</span><span class="sxs-lookup"><span data-stu-id="8d0c6-p102">Email messages are represented by the [message](../resources/message.md) resource and organized in a [mailFolder](../resources/mailfolder.md). Messages and mail folders are identified by their **id** property, obtainable from `GET` operations.</span></span>

><span data-ttu-id="8d0c6-p103">**Примечание.** Идентификаторы **message** и **mailfolder** не являются уникальными и неизменяемыми в почтовом ящике. Они могут изменяться после копирования, перемещения или отправки.</span><span class="sxs-lookup"><span data-stu-id="8d0c6-p103">**Note:** In general, do not assume that **message** and **mailfolder** IDs are unique and immutable within a mailbox. They might change after certain actions such as copy, move, or send.</span></span>

<span data-ttu-id="8d0c6-111">Сообщения могут быть в формате HTML или текстовом формате.</span><span class="sxs-lookup"><span data-stu-id="8d0c6-111">Message bodies can be in HTML or text format.</span></span>

<span data-ttu-id="8d0c6-112">Можно использовать имена известных папок, таких как `Inbox`, `Drafts`, `SentItems`, или `DeletedItems` для идентификации определенных почтовых папок, существующих по умолчанию для всех пользователей.</span><span class="sxs-lookup"><span data-stu-id="8d0c6-112">You can use well-known folder names such as `Inbox`, `Drafts`, `SentItems`, or `DeletedItems` to identify certain mail folders that exist by default for all users.</span></span> <span data-ttu-id="8d0c6-113">Список поддерживаемых известных имен см. в статье [Тип ресурса mailFolder](../resources/mailfolder.md).</span><span class="sxs-lookup"><span data-stu-id="8d0c6-113">For a list of supported well-known folder names, see [mailFolder resource type](../resources/mailfolder.md).</span></span>

<span data-ttu-id="8d0c6-114">Например можно получить сообщения в папке Outlook **Отправленные** пользователь выполнил вход без получения идентификатор папки:</span><span class="sxs-lookup"><span data-stu-id="8d0c6-114">For example, you can get messages in the Outlook **Sent Items** folder of the signed-in user, without first getting the folder ID:</span></span>

```http
GET /me/mailFolders('SentItems')/messages?$select=sender,subject
```

## <a name="common-use-cases"></a><span data-ttu-id="8d0c6-115">Основные варианты использования</span><span class="sxs-lookup"><span data-stu-id="8d0c6-115">Common use cases</span></span>

<span data-ttu-id="8d0c6-116">Ресурс **message** предоставляет такие свойства, как **categories**, **conversationId**, **flag** и **importance**, которые соответствуют функциям, доступным в пользовательском интерфейсе, позволяя приложениям автоматизировать работу или интегрироваться со встроенными возможностями Outlook.</span><span class="sxs-lookup"><span data-stu-id="8d0c6-116">The **message** resource exposes properties such as **categories**, **conversationId**, **flag**, and **importance** that correspond to features available in the UI, allowing apps to automate or integrate with the built-in Outlook user experience.</span></span>

<span data-ttu-id="8d0c6-117">В API Microsoft Graph также есть методы и действия, которые поддерживают основные варианты использования сообщений.</span><span class="sxs-lookup"><span data-stu-id="8d0c6-117">The Microsoft Graph API also provides methods and actions that support common use cases of messages.</span></span>

| <span data-ttu-id="8d0c6-118">Варианты использования</span><span class="sxs-lookup"><span data-stu-id="8d0c6-118">Use cases</span></span> | <span data-ttu-id="8d0c6-119">Ресурсы REST</span><span class="sxs-lookup"><span data-stu-id="8d0c6-119">REST resources</span></span> | <span data-ttu-id="8d0c6-120">См. также</span><span class="sxs-lookup"><span data-stu-id="8d0c6-120">See also</span></span> |
|:----------|:---------------|:---------|
| <span data-ttu-id="8d0c6-121">**Действия, ориентированные на пользователя**</span><span class="sxs-lookup"><span data-stu-id="8d0c6-121">**User-centric actions**</span></span> | | |
| <span data-ttu-id="8d0c6-122">Создание, чтение, ответ, пересылка, отправка, обновление или удаление сообщений</span><span class="sxs-lookup"><span data-stu-id="8d0c6-122">Draft, read, reply, forward, send, update, or delete messages</span></span> | [<span data-ttu-id="8d0c6-123">message</span><span class="sxs-lookup"><span data-stu-id="8d0c6-123">message</span></span>](../resources/message.md) | [<span data-ttu-id="8d0c6-124">Методы ресурса message</span><span class="sxs-lookup"><span data-stu-id="8d0c6-124">Methods of message</span></span>](../resources/message.md#methods) |
| <span data-ttu-id="8d0c6-125">Предоставление другому пользователю права отправлять сообщения от имени владельца почтового ящика</span><span class="sxs-lookup"><span data-stu-id="8d0c6-125">Delegate another user to send messages on behalf of the mailbox owner</span></span> | [<span data-ttu-id="8d0c6-126">message</span><span class="sxs-lookup"><span data-stu-id="8d0c6-126">message</span></span>](../resources/message.md) | <span data-ttu-id="8d0c6-127">Задание свойств **from** и **sender** в ресурсе [message](../resources/message.md)</span><span class="sxs-lookup"><span data-stu-id="8d0c6-127">Setting the **from** and **sender** properties in a [message](../resources/message.md)</span></span> |
| <span data-ttu-id="8d0c6-128">Показ более важных сообщений</span><span class="sxs-lookup"><span data-stu-id="8d0c6-128">Let user view more important messages first</span></span> | [<span data-ttu-id="8d0c6-129">inferenceClassificationOverride</span><span class="sxs-lookup"><span data-stu-id="8d0c6-129">inferenceClassificationOverride</span></span>](../resources/inferenceClassificationOverride.md) | [<span data-ttu-id="8d0c6-130">Сортировка почты</span><span class="sxs-lookup"><span data-stu-id="8d0c6-130">Focused Inbox</span></span>](../resources/manage_focused_inbox.md) |
| <span data-ttu-id="8d0c6-131">Добавление, получение или удаление вложений сообщения</span><span class="sxs-lookup"><span data-stu-id="8d0c6-131">Add, get, or delete attachments of a message</span></span> | <span data-ttu-id="8d0c6-132">[attachment](../resources/attachment.md),</span><span class="sxs-lookup"><span data-stu-id="8d0c6-132">[attachment](../resources/attachment.md),</span></span> <br> <span data-ttu-id="8d0c6-133">[fileAttachment](../resources/fileattachment.md),</span><span class="sxs-lookup"><span data-stu-id="8d0c6-133">[fileAttachment](../resources/fileattachment.md),</span></span> <br> <span data-ttu-id="8d0c6-134">[itemAttachment](../resources/itemattachment.md),</span><span class="sxs-lookup"><span data-stu-id="8d0c6-134">[itemAttachment](../resources/itemattachment.md),</span></span> <br> <span data-ttu-id="8d0c6-135">[referenceAttachment](../resources/referenceattachment.md),</span><span class="sxs-lookup"><span data-stu-id="8d0c6-135">[referenceAttachment](../resources/referenceattachment.md),</span></span> <br> [<span data-ttu-id="8d0c6-136">message</span><span class="sxs-lookup"><span data-stu-id="8d0c6-136">message</span></span>](../resources/message.md) | [<span data-ttu-id="8d0c6-137">Методы ресурса attachment</span><span class="sxs-lookup"><span data-stu-id="8d0c6-137">Methods of attachment</span></span>](../resources/attachment.md#methods) |
| <span data-ttu-id="8d0c6-138">Получение или обновление автоматического ответа, языкового стандарта, часового пояса или рабочего времени пользователя</span><span class="sxs-lookup"><span data-stu-id="8d0c6-138">Get or update a user's automatic reply, locale, time zone, or working hours</span></span> | <span data-ttu-id="8d0c6-139">[mailboxSettings](../resources/mailboxsettings.md),</span><span class="sxs-lookup"><span data-stu-id="8d0c6-139">[mailboxSettings](../resources/mailboxsettings.md),</span></span> <br> <span data-ttu-id="8d0c6-140">[automaticRepliesSetting](../resources/automaticrepliessetting.md),</span><span class="sxs-lookup"><span data-stu-id="8d0c6-140">[automaticRepliesSetting](../resources/automaticrepliessetting.md),</span></span> <br> <span data-ttu-id="8d0c6-141">[localeInfo](../resources/localeinfo.md),</span><span class="sxs-lookup"><span data-stu-id="8d0c6-141">[localeInfo](../resources/localeinfo.md),</span></span> <br> [<span data-ttu-id="8d0c6-142">workingHours</span><span class="sxs-lookup"><span data-stu-id="8d0c6-142">workingHours</span></span>](../resources/workinghours.md) | <span data-ttu-id="8d0c6-143">[Получение настроек почтового ящика пользователя](../api/user_get_mailboxsettings.md),</span><span class="sxs-lookup"><span data-stu-id="8d0c6-143">[Get user's mailbox settings](../api/user_get_mailboxsettings.md),</span></span> <br> [<span data-ttu-id="8d0c6-144">Обновление параметров почтового ящика пользователя</span><span class="sxs-lookup"><span data-stu-id="8d0c6-144">Update user's mailbox settings</span></span>](../api/user_update_mailboxsettings.md) |
| <span data-ttu-id="8d0c6-145">Получите подсказки специальные состояние других получателей, например, документов office</span><span class="sxs-lookup"><span data-stu-id="8d0c6-145">Get MailTips of other recipients' special status, such as out-of-office</span></span> | <span data-ttu-id="8d0c6-146">[пользователь](../resources/user.md)</span><span class="sxs-lookup"><span data-stu-id="8d0c6-146">[user](../resources/user.md),</span></span> <br> [<span data-ttu-id="8d0c6-147">почтовые подсказки</span><span class="sxs-lookup"><span data-stu-id="8d0c6-147">mailTips</span></span>](../resources/mailtips.md) | [<span data-ttu-id="8d0c6-148">Получите подсказки</span><span class="sxs-lookup"><span data-stu-id="8d0c6-148">Get MailTips</span></span>](../api/user_getmailtips.md) |
| <span data-ttu-id="8d0c6-149">**Управление почтой и папками**</span><span class="sxs-lookup"><span data-stu-id="8d0c6-149">**Mail and folder management**</span></span> | | |
| <span data-ttu-id="8d0c6-150">Упорядочивание сообщений в иерархии папок почты</span><span class="sxs-lookup"><span data-stu-id="8d0c6-150">Organize messages in a mail folder hierarchy</span></span> | [<span data-ttu-id="8d0c6-151">mailFolder</span><span class="sxs-lookup"><span data-stu-id="8d0c6-151">mailFolder</span></span>](../resources/mailfolder.md)  | [<span data-ttu-id="8d0c6-152">Методы ресурса mailFolder</span><span class="sxs-lookup"><span data-stu-id="8d0c6-152">Methods of mailFolder</span></span>](../resources/mailfolder.md#methods) |
| <span data-ttu-id="8d0c6-153">Поиск и фильтрация сообщений</span><span class="sxs-lookup"><span data-stu-id="8d0c6-153">Search and filter messages</span></span> | [<span data-ttu-id="8d0c6-154">message</span><span class="sxs-lookup"><span data-stu-id="8d0c6-154">message</span></span>](../resources/message.md) | [<span data-ttu-id="8d0c6-155">Параметры запроса</span><span class="sxs-lookup"><span data-stu-id="8d0c6-155">Query parameters</span></span>](../../../concepts/query_parameters.md)  |
| <span data-ttu-id="8d0c6-156">Получение уведомлений об изменениях сообщений в папке</span><span class="sxs-lookup"><span data-stu-id="8d0c6-156">Get notified of changes to messages in a folder</span></span> | [<span data-ttu-id="8d0c6-157">subscription</span><span class="sxs-lookup"><span data-stu-id="8d0c6-157">subscription</span></span>](../resources/subscription.md) | [<span data-ttu-id="8d0c6-158">Работа с веб-перехватчиками в Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="8d0c6-158">Working with webhooks in Microsoft Graph</span></span>](../resources/webhooks.md) |
| <span data-ttu-id="8d0c6-159">Синхронизация сообщений или иерархии папок почты</span><span class="sxs-lookup"><span data-stu-id="8d0c6-159">Synchronize messages or mail folder hierarchy</span></span> | [<span data-ttu-id="8d0c6-160">message</span><span class="sxs-lookup"><span data-stu-id="8d0c6-160">message</span></span>](../resources/message.md) | [<span data-ttu-id="8d0c6-161">Получение добавочных изменений сообщений в папке</span><span class="sxs-lookup"><span data-stu-id="8d0c6-161">Get incremental changes to messages in a folder</span></span>](../../../concepts/delta_query_messages.md) |
| <span data-ttu-id="8d0c6-162">**Разработка приложений**</span><span class="sxs-lookup"><span data-stu-id="8d0c6-162">**App development**</span></span> | | |
| <span data-ttu-id="8d0c6-163">Добавление данных пользовательское приложение как заголовки сообщений Интернета сообщения</span><span class="sxs-lookup"><span data-stu-id="8d0c6-163">Add custom app data as Internet message headers of a message</span></span> | [<span data-ttu-id="8d0c6-164">message</span><span class="sxs-lookup"><span data-stu-id="8d0c6-164">message</span></span>](../resources/message.md) | <span data-ttu-id="8d0c6-165">Добавление пользовательских данных для свойства **internetMessageHeaders** сообщение.</span><span class="sxs-lookup"><span data-stu-id="8d0c6-165">Add custom data to the **internetMessageHeaders** property of the message.</span></span> |
| <span data-ttu-id="8d0c6-166">Добавление пользовательских данных приложения в сообщение с помощью расширений</span><span class="sxs-lookup"><span data-stu-id="8d0c6-166">Add custom app data to a message by using extensions</span></span> | <span data-ttu-id="8d0c6-167">[openTypeExtension](../resources/opentypeextension.md),</span><span class="sxs-lookup"><span data-stu-id="8d0c6-167">[openTypeExtension](../resources/opentypeextension.md),</span></span> <br>[<span data-ttu-id="8d0c6-168">schemaExtension</span><span class="sxs-lookup"><span data-stu-id="8d0c6-168">schemaExtension</span></span>](../resources/schemaextension.md) | [<span data-ttu-id="8d0c6-169">Добавление пользовательских данных в ресурсы с помощью расширений</span><span class="sxs-lookup"><span data-stu-id="8d0c6-169">Add custom data to resources using extensions</span></span>](../../../concepts/extensibility_overview.md) |
| <span data-ttu-id="8d0c6-170">Доступ к пользовательским данным для редко предоставляемых свойств Outlook MAPI</span><span class="sxs-lookup"><span data-stu-id="8d0c6-170">Access custom data for under-exposed Outlook MAPI properties</span></span> | <span data-ttu-id="8d0c6-171">[singleValueLegacyExtendedProperty](../resources/singlevaluelegacyextendedproperty.md),</span><span class="sxs-lookup"><span data-stu-id="8d0c6-171">[singleValueLegacyExtendedProperty](../resources/singlevaluelegacyextendedproperty.md),</span></span> <br> [<span data-ttu-id="8d0c6-172">multiValueLegacyExtendedProperty</span><span class="sxs-lookup"><span data-stu-id="8d0c6-172">multiValueLegacyExtendedProperty</span></span>](../resources/multivaluelegacyextendedproperty.md) | [<span data-ttu-id="8d0c6-173">Общие сведения о расширенных свойствах Outlook</span><span class="sxs-lookup"><span data-stu-id="8d0c6-173">Outlook extended properties overview</span></span>](../resources/extended-properties-overview.md) |

## <a name="next-steps"></a><span data-ttu-id="8d0c6-174">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="8d0c6-174">Next steps</span></span>

<span data-ttu-id="8d0c6-175">API почты открывает новые способы взаимодействия с пользователями:</span><span class="sxs-lookup"><span data-stu-id="8d0c6-175">The mail API can open up new ways for you to engage with users:</span></span>

- [<span data-ttu-id="8d0c6-176">Обзор API почты Outlook</span><span class="sxs-lookup"><span data-stu-id="8d0c6-176">Outlook mail API overview</span></span>](../../../concepts/outlook-mail-concept-overview.md)
- <span data-ttu-id="8d0c6-177">Узнайте больше о [методах](../resources/message.md#methods), [свойствах](../resources/message.md#properties) и [отношениях](../resources/message.md#relationships) ресурсов [message](../resources/message.md) и [mailFolder](../resources/mailfolder.md).</span><span class="sxs-lookup"><span data-stu-id="8d0c6-177">Drill down on the [methods](../resources/message.md#methods), [properties](../resources/message.md#properties), and [relationships](../resources/message.md#relationships) of the [message](../resources/message.md) and [mailFolder](../resources/mailfolder.md) resources.</span></span>
- <span data-ttu-id="8d0c6-178">Опробуйте API в [песочнице Graph](https://developer.microsoft.com/graph/graph-explorer).</span><span class="sxs-lookup"><span data-stu-id="8d0c6-178">Try the API in the [Graph Explorer](https://developer.microsoft.com/graph/graph-explorer).</span></span>

<span data-ttu-id="8d0c6-p105">Нужны идеи? Посмотрите, [как наши партнеры используют Microsoft Graph](https://developer.microsoft.com/graph/graph/examples#partners).</span><span class="sxs-lookup"><span data-stu-id="8d0c6-p105">Need more ideas? See [how some of our partners are using Microsoft Graph](https://developer.microsoft.com/graph/graph/examples#partners).</span></span>

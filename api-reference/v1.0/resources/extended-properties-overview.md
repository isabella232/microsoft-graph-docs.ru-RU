# <a name="outlook-extended-properties-overview"></a>Общие сведения о расширенных свойствах Outlook

Расширенные свойства позволяют хранить пользовательские данные и специально служат в качестве резервного механизма для приложений, чтобы получать доступ к пользовательским данным для свойств Outlook MAPI, когда эти свойства _еще не представлены в метаданных API Microsoft Graph_. Можно использовать расширенные свойства API REST, чтобы хранить или получать такие пользовательские данные в следующих пользовательских ресурсах:

- [message](../resources/message.md);
- [mailFolder](../resources/mailfolder.md);
- [event](../resources/event.md);
- [calendar](../resources/calendar.md);
- [contact](../resources/contact.md);
- [contactFolder](../resources/contactfolder.md). 

Или в следующих ресурсах группы Office 365:

- group [event](../resources/event.md);
- [calendar](../resources/calendar.md) для групп;
- [post](../resources/post.md) для групп. 

## <a name="use-extended-properties-or-open-extensions"></a>Что использовать — расширенные свойства или открытые расширения

В большинстве часто применяемых сценариев у вас должна быть возможность использования открытых расширений (они представлены объектом [openTypeExtension](../resources/opentypeextension.md) и ранее звались расширениями данных Office 365), чтобы хранить пользовательские данные и получать к ним доступ для экземпляров ресурса в почтовом ящике пользователя. Используйте расширенные свойства, только если вам нужно получить доступ к пользовательским данным для свойств MAPI Outlook, которые еще не предоставлены в [метаданных API Microsoft Graph](http://developer.microsoft.com/ru-RU/graph/docs/overview/call_api). 

## <a name="types-of-extended-properties"></a>Типы расширенных свойств

В зависимости от того, собираетесь ли вы хранить одно или несколько значений (одинакового типа) в расширенном свойстве, можно создавать расширенное свойство [singleValueLegacyExtendedProperty](../resources/singleValueLegacyExtendedProperty.md) или [multiValueLegacyExtendedProperty](../resources/multiValueLegacyExtendedProperty.md).

Каждый из этих типов определяет свойство по идентификатору **id** и хранит данные в значении **value**. 

Можно использовать идентификатор **id** для получения конкретного экземпляра ресурса с расширенным свойством или фильтровать расширенное свойство с одним значением для получения всех экземпляров с таким свойством. 

**Примечание.** Невозможно использовать API REST для получения всех расширенных свойств конкретного экземпляра в одном вызове.
  

### <a name="id-formats"></a>Форматы идентификаторов

При создании расширенного свойства с одним или несколькими значениями свойство **id** можно указывать в одном из двух форматов: на основе имени строки (**Name**) или числового идентификатора (**Id**), а также на основе фактического типа значения или значений свойства. В следующих двух таблицах описаны поддерживаемые форматы для указания расширенных свойств с одним или несколькими значениями. {_тип_} представляет собой тип значения или значений свойства. В примерах показаны типы string, integer и массивы этих типов.

Поскольку расширенные свойства в большинстве случаев взаимодействуют с определенными свойствами MAPI, не представленными в метаданных API Microsoft Graph, выбранный вами формат должен отражать формат [идентификатора свойства MAPI](https://msdn.microsoft.com/ru-RU/library/office/cc815528.aspx) (строка символов или числовое значение).
Информацию о соответствии расширенных свойств и существующих свойств MAPI, таких как идентификатор свойства или GUID, можно найти в статье \[\][MS-OXPROPS: Основной список свойств для протоколов Exchange Server](https://msdn.microsoft.com/en-us/library/cc433490%28v=exchg.80%29.aspx).

**Примечание.** После выбора формата для свойства **id** получайте доступ к этому расширенному свойству, используя только этот формат.


**Действительные форматы идентификаторов для расширенных свойств с одним значением**

|**Формат**|**Пример**|**Описание**|
|:---------|:----------|:--------------|
| "{_тип_} {_guid_} **Name** {_имя_}" | ```"String {8ECCC264-6880-4EBE-992F-8888D2EEAA1D} Name TestProperty"``` | Определяет свойство по пространству имен (GUID), к которому оно принадлежит, и имени.         |
| "{_тип_} {_guid_} **Id** {_идентификатор_}"     | ```"Integer {8ECCC264-6880-4EBE-992F-8888D2EEAA1D} Id 0x8012"```        | Определяет свойство по пространству имен (GUID), к которому оно принадлежит, и идентификатору.  |

**Действительные форматы идентификаторов для расширенных свойств с несколькими значениями**

|**Формат**|**Пример**|**Описание**|
|:---------|:----------|:--------------|
| "{_тип_} {_guid_} **Name** {_имя_}" | ```"StringArray {8ECCC264-6880-4EBE-992F-8888D2EEAA1D} Name TestProperty"``` | Определяет свойство по пространству имен (GUID) и имени.         |
| "{_тип_} {_guid_} **Id** {_идентификатор_}"     | ```"IntegerArray {8ECCC264-6880-4EBE-992F-8888D2EEAA1D} Id 0x8013"```        | Определяет свойство по пространству имен (GUID) и идентификатору.   |

### <a name="rest-api-operations"></a>Операции с API REST
 
Ниже приведены операции с расширенными свойствами с одним значением.

- [Создание расширенного свойства в новом или существующем экземпляре ресурса](../api/singlevaluelegacyextendedproperty_post_singlevalueextendedproperties.md)
- [Получение одного или коллекции экземпляров ресурсов с расширенным свойством с помощью параметра `$expand` или `$filter`](../api/singlevaluelegacyextendedproperty_get.md)

Ниже приведены операции с расширенными свойствами с несколькими значениями.

- [Создание расширенного свойства в новом или существующем экземпляре ресурса](../api/multivaluelegacyextendedproperty_post_multivalueextendedproperties.md)
- [Получение экземпляра ресурса с расширенным свойством с помощью параметра `$expand`](../api/multivaluelegacyextendedproperty_get.md)

